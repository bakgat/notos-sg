(function () {
    'use strict';

    angular
        .module('notos', [
            //shared modules
            'notos.core',
            'notos.layout',
            'notos.data',
            'notos.widgets',

            //app modules
            'notos.dashboard',
            'notos.filter',
            'notos.websites'
        ]);
})();
angular
    .module('notos.core', [
        //Angular
        'ngAnimate', 'ngSanitize', 'ngResource',

        //3rd party
        'ui.bootstrap',
        'ncy-angular-breadcrumb',
        'restangular',

        //cross app modules
        'blocks.exception',
        'blocks.logger',
        'blocks.router'
    ]);
(function () {
    'use strict';

    angular
        .module('notos.dashboard', []);
})();
(function () {
    'use strict';

    angular
        .module('notos.data', []);
})();
(function () {
    'use strict';

    angular
        .module('notos.filter', []);
})();
(function () {
    'use strict';

    angular
        .module('notos.layout', []);
})();
(function () {
    'use strict';

    angular
        .module('notos.websites', []);
})();
(function () {
    'use strict';

    angular
        .module('notos.widgets', []);
})();
(function () {
    'use strict';

    angular
        .module('blocks.exception', ['blocks.logger']);
})();
(function () {
    'use strict';

    angular
        .module('blocks.logger', []);
})();
(function () {
    'use strict';

    angular
        .module('blocks.router', [
            'ui.router'
        ]);
})();
/**
 * notos.core
 * FACTORY: Base64
 */

(function () {
    'use strict';

    angular
        .module('notos.core')
        .factory('Base64', Base64);

    /* @ngInject */
    function Base64() {
        var keyStr = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=';
        var service = {
            encode: encode,
            decode: decode
        }

        return service;
        ////////////////

        function encode(input) {
            var output = "";
            var chr1, chr2, chr3 = "";
            var enc1, enc2, enc3, enc4 = "";
            var i = 0;

            do {
                chr1 = input.charCodeAt(i++);
                chr2 = input.charCodeAt(i++);
                chr3 = input.charCodeAt(i++);

                enc1 = chr1 >> 2;
                enc2 = ((chr1 & 3) << 4) | (chr2 >> 4);
                enc3 = ((chr2 & 15) << 2) | (chr3 >> 6);
                enc4 = chr3 & 63;

                if (isNaN(chr2)) {
                    enc3 = enc4 = 64;
                } else if (isNaN(chr3)) {
                    enc4 = 64;
                }

                output = output +
                    keyStr.charAt(enc1) +
                    keyStr.charAt(enc2) +
                    keyStr.charAt(enc3) +
                    keyStr.charAt(enc4);
                chr1 = chr2 = chr3 = "";
                enc1 = enc2 = enc3 = enc4 = "";
            } while (i < input.length);

            return output;
        }

        function decode(input) {
            var output = "";
            var chr1, chr2, chr3 = "";
            var enc1, enc2, enc3, enc4 = "";
            var i = 0;

            // remove all characters that are not A-Z, a-z, 0-9, +, /, or =
            var base64test = /[^A-Za-z0-9\+\/\=]/g;
            if (base64test.exec(input)) {
                window.alert("There were invalid base64 characters in the input text.\n" +
                    "Valid base64 characters are A-Z, a-z, 0-9, '+', '/',and '='\n" +
                    "Expect errors in decoding.");
            }
            input = input.replace(/[^A-Za-z0-9\+\/\=]/g, "");

            do {
                enc1 = keyStr.indexOf(input.charAt(i++));
                enc2 = keyStr.indexOf(input.charAt(i++));
                enc3 = keyStr.indexOf(input.charAt(i++));
                enc4 = keyStr.indexOf(input.charAt(i++));

                chr1 = (enc1 << 2) | (enc2 >> 4);
                chr2 = ((enc2 & 15) << 4) | (enc3 >> 2);
                chr3 = ((enc3 & 3) << 6) | enc4;

                output = output + String.fromCharCode(chr1);

                if (enc3 != 64) {
                    output = output + String.fromCharCode(chr2);
                }
                if (enc4 != 64) {
                    output = output + String.fromCharCode(chr3);
                }

                chr1 = chr2 = chr3 = "";
                enc1 = enc2 = enc3 = enc4 = "";

            } while (i < input.length);

            return output;
        }
    };
})();
/**
 * notos.core
 * FACTORY: common
 */

(function () {
    'use strict';

    angular
        .module('notos.core')
        .factory('common', common);

    function common($q, $rootScope, $timeout, logger) {

        var service = {
            // common angular dependencies
            $broadcast: $broadcast,
            $q: $q,
            $timeout: $timeout,
            // generic
            isNumber: isNumber,
            logger: logger,
            textContains: textContains
        }

        return service;
        ////////////////////////

        function $broadcast() {
            return $rootScope.$broadcast.apply($rootScope, arguments);
        }


        function isNumber(val) {
            // negative or positive
            return (/^[-]?\d+$/).test(val);
        }

        function textContains(text, searchText) {
            return text && -1 !== text.toLowerCase().indexOf(searchText.toLowerCase());
        }
    }
    common.$inject = ["$q", "$rootScope", "$timeout", "logger"];
})();
(function () {
    'use strict';

    var core = angular.module('notos.core');

    core.config(toastrConfig);

    /* @ngInject */
    function toastrConfig(toastr) {
        toastr.options.timeOut = 4000;
        toastr.options.closeButton = true;
        toastr.options.progressBar = true;
        toastr.options.positionClass = 'toast-bottom-right';
    }
    toastrConfig.$inject = ["toastr"];

    var config = {
        appErrorPrefix: '[Fout] ',
        appTitle: 'noTos',
        version: '1.0.0'
    };

    core.value('config', config);

    core.config(configure);

    core.run(afterViewContentLoaded);

    core.run(set404);


    /* @ngInject */
    function configure($urlRouterProvider, $stateProvider,
                       routehelperConfigProvider, $breadcrumbProvider,
                       RestangularProvider) {

        configureRouting();
        configureBreadcrumb();

        configureRestangular();

        function configureRouting() {
            routehelperConfigProvider.config.$urlRouterProvider = $urlRouterProvider;
            routehelperConfigProvider.config.$stateProvider = $stateProvider;

            routehelperConfigProvider.config.title = config.appTitle;
        }

        function configureBreadcrumb() {
            $breadcrumbProvider.setOptions({
                prefixStateName: 'index',
                template: 'bootstrap3',
                includeAbstract: true
            });
        }

        function configureRestangular() {
            var baseUrl = '/api';

            RestangularProvider.setBaseUrl(baseUrl);
        }


    }
    configure.$inject = ["$urlRouterProvider", "$stateProvider", "routehelperConfigProvider", "$breadcrumbProvider", "RestangularProvider"];

    /* @ngInject */
    function afterViewContentLoaded($rootScope) {
        $rootScope.$on('$viewContentLoaded',function(){
            angular.element('html, body').animate({ scrollTop: 0 }, 200);
        })
    }
    afterViewContentLoaded.$inject = ["$rootScope"];

    /* @ngInject */
    function set404($rootScope) {
        $rootScope.$on('$stateChangeError', function(event) {
            event.preventDefault();
            $state.go('error.404');
        });
    }
    set404.$inject = ["$rootScope"];

})();
/* global toastr:false, moment:false */
(function() {
    'use strict';

    angular
        .module('notos.core')
        .constant('toastr', toastr)
        .constant('moment', moment)
        .constant('_', window._);
})();
/**
 * ROUTES: notos.core
 */
(function () {
    'use strict';

    angular
        .module('notos.core')
        .run(configRoutes);

    /* @ngInject */
    function configRoutes(routehelper) {
        routehelper.configureStates(getStates());
    }
    configRoutes.$inject = ["routehelper"];;

    function getStates() {
        return [
            {
                state: 'error',
                config: {
                    abstract: true,
                    url: '/error',
                    views: {
                        'main@': {
                            templateUrl: 'js/modules/layout/main.html'
                        }
                    },
                    title: 'Fout'
                }
            },
            {
                state: 'error.404',
                config: {
                    url: '/404',
                    views: {
                        'content@error': {
                            templateUrl: 'js/modules/core/errors/404.html'
                        },
                    },
                    title: 'Pagina niet gevonden'
                }
            }
        ];
    };
})();
/**
 * notos.dashboard
 * CONTROLLER: DashboardController
 */
(function () {
    'use strict';

    angular
        .module('notos.dashboard')
        .controller('DashboardController', DashboardController);

    /* @ngInject */
    function DashboardController($scope, Tag, Website, Level,
                                 SearchWebsiteFilter) {
        /*jshint validthis: true */
        var vm = this;

        vm.websites = [];
        vm.filtered = [];
        vm.tags = [];
        vm.levels = [];

        vm.filter = {
            levels: [],
            tags: [],
            terms: ''
        }

        vm.addLevelFilter = addLevelFilter;
        vm.removeLevelFilter = removeLevelFilter;
        vm.addTagFilter = addTagFilter;
        vm.removeTagFilter = removeTagFilter;

        vm.filterFlag = false;

        vm.itemsPerPage = 10;
        vm.currentPage = 1;
        vm.totalItems = 0;


        activate();
        ///////////

        function activate() {
            getTags();
            getLevels();
            getWebsites().then(function () {
                setFilterFlag();
            });


        }

        function getTags() {
            return Tag.getList().then(tagsCompleted);

            function tagsCompleted(response) {
                return vm.tags = response;
            }
        }

        function getLevels() {
            return Level.getList().then(levelCompleted);

            function levelCompleted(response) {
                return vm.levels = response;
            }
        }

        function getWebsites() {
            return Website.full().then(websitesCompleted);

            function websitesCompleted(response) {
                return vm.websites = response;
            }
        }

        function addLevelFilter(level) {
            vm.filter.levels.push(level);
            var index = vm.levels.indexOf(level);
            vm.levels.splice(index, 1);
        }

        function removeLevelFilter(level) {
            vm.levels.push(level);
            var index = vm.filter.levels.indexOf(level);
            vm.filter.levels.splice(index, 1);
        }

        function addTagFilter(tag) {
            vm.filter.tags.push(tag);
            var index = vm.tags.indexOf(tag);
            vm.tags.splice(index, 1);
        }

        function removeTagFilter(tag) {
            vm.tags.push(tag);
            var index = vm.filter.tags.indexOf(tag);
            vm.filter.tags.splice(index, 1);
        }

        $scope.$watch('vm.filter', function (tags) {
            if (vm.websites.length) {
                var websites = [];
                vm.filtered = SearchWebsiteFilter(vm.websites, vm.filter);
            }
            setFilterFlag();
        }, true);

        $scope.$watchGroup(['vm.currentPage', 'vm.totalItems', 'vm.itemsPerPage'], function () {
            setPaginationText();
        });


        function setFilterFlag() {
            vm.filterFlag = vm.filter.levels.length ||
                vm.filter.tags.length ||
                vm.filter.terms;

            if (!vm.filterFlag) {
                vm.filtered = vm.websites;
            }
            vm.totalItems = vm.filtered.length;

            setPaginationText();
        }

        function setPaginationText() {
            var total = vm.filtered.length;
            var floor = ((vm.currentPage - 1) * vm.itemsPerPage) + 1;
            var ceil = floor + (vm.itemsPerPage - 1);
            if (ceil > total) {
                ceil = total;
            }

            if (total > 0 && total > vm.itemsPerPage) {
                vm.paginationText = 'Toont ' + floor +
                    (total > 1 ? ' - ' + ' ' + ceil : '') +
                    ' (van ' + total + ' websites)';
            } else {
                vm.paginationText = '';
            }
        }
    }
    DashboardController.$inject = ["$scope", "Tag", "Website", "Level", "SearchWebsiteFilter"];
})();
/**
 * ROUTES: notos.dashboard
 */
(function () {
    'use strict';

    angular
        .module('notos.dashboard')
        .run(configRoutes);

    /* @ngInject */
    function configRoutes(routehelper) {
        routehelper.configureStates(getStates());
    }
    configRoutes.$inject = ["routehelper"];;

    function getStates() {
        return [
            {
                state: 'index',
                config: {
                    abstract: true,
                    url: '/index',
                    views: {
                        'main@': {
                            templateUrl: 'js/modules/layout/main.html'
                        }
                    },
                    title: 'start'
                }
            },
            {
                state: 'index.dashboard',
                config: {
                    url: '/dashboard',
                    views: {
                        'content@index': {
                            templateUrl: 'js/modules/dashboard/dashboard.html',
                            controller: 'DashboardController',
                            controllerAs: 'vm'
                        }
                    },
                    title: 'Dashboard'
                }
            }
        ];
    };
})();
/**
 * notos.data
 * FILTER: Highlight
 */
(function () {
    'use strict';

    angular
        .module('notos.data')
        .filter('Highlight', Highlight);

    /**
     *
     */
    function Highlight($sce) {
        return function (str, termsToHighlight) {
            if (termsToHighlight === '') {
                return $sce.trustAsHtml(str);
            }
            // Sort terms by length
            termsToHighlight = termsToHighlight.split(" ");
            termsToHighlight.sort(function (a, b) {
                return b.length - a.length;
            });

            // Regex to simultaneously replace terms
            var regex = new RegExp('(?!<[^>]*?>)' + termsToHighlight.join('|') + '(?![^<]*?</[^>]*?>)', 'gi');
            return $sce.trustAsHtml(str.replace(regex, '<span class="match">$&</span>'));
        };
    }
    Highlight.$inject = ["$sce"];

})();
/**
 * notos.data
 * FACTORY: HTTPCache
 */

(function () {
    'use strict';

    angular
        .module('notos.data')
        .factory('HTTPCache', HTTPCache);

    /* @ngInject */
    function HTTPCache(Restangular, $cacheFactory) {
        var cache;
        cache = $cacheFactory('http');

        return Restangular.withConfig(function (RestangularConfigurer) {
            RestangularConfigurer.setDefaultHttpFields({cache: cache});
            RestangularConfigurer.setResponseInterceptor(function (response, operation) {
                if (operation === 'put' || operation === 'post' || operation === 'delete') {
                    cache.removeAll();
                }
                return response;
            });

            // Custom Global Method(s) for Restangularized Elements.
            RestangularConfigurer.setOnElemRestangularized(function(elem, isCollection) {
                elem.clearCache = function() {
                    cache.removeAll();
                }
                return elem;
            });
        });
    }
    HTTPCache.$inject = ["Restangular", "$cacheFactory"];
})();
/**
 * notos.filter
 * FACTORY: Level
 */

(function () {
    'use strict';

    angular
        .module('notos.filter')
        .factory('Level', Level);

    /* @ngInject */
    function Level(HTTPCache) {
        var service = HTTPCache.service('group').one('levels');

        return service;

    }
    Level.$inject = ["HTTPCache"];
})();
/**
 * notos.filter
 * FACTORY: Tag
 */

(function () {
    'use strict';

    angular
        .module('notos.filter')
        .factory('Tag', Tag);

    /* @ngInject */
    function Tag(HTTPCache) {
        var service = HTTPCache.service('tags');

        return service;
    }
    Tag.$inject = ["HTTPCache"];
})();
/**
 * notos.layout
 * CONTROLLER: ShellController
 */
(function () {
    'use strict';

    angular
        .module('notos.layout')
        .controller('ShellController', ShellController);

    /* @ngInject */
    function ShellController() {
        /*jshint validthis: true */
        var vm = this;


        activate();
        /////////////


        function activate() {

        }


    }


})();
/**
 * notos.websites
 * FILTER: ByLevel
 */
(function () {
    'use strict';

    angular
        .module('notos.websites')
        .filter('ByLevel', ByLevel);

    /**
     *
     */
    function ByLevel(_) {
        return function (websites, levels) {
            var filtered = [];
            angular.forEach(websites, function (website) {
                angular.forEach(website.objectives, function (objective) {
                    angular.forEach(objective.levels, function(level) {
                        if (_.some(levels, function(l) { return level.group && l.id === level.group.id; })) {
                            if (level.level > 0 && filtered.indexOf(website) === -1) {
                                filtered.push(website);
                            }
                        }
                    });

                });
            });
            return filtered;
        }
    }
    ByLevel.$inject = ["_"];
})();
/**
 * notos.websites
 * FILTER: ByObjective
 */
(function () {
    'use strict';

    angular
        .module('notos.websites')
        .filter('ByObjective', ByObjective);

    /**
     *
     */
    function ByObjective() {
    }
})();
/**
 * notos.websites
 * FILTER: TagFilter
 */
(function () {
    'use strict';

    angular
        .module('notos.websites')
        .filter('ByTag', ByTag);

    /**
     *
     */
    function ByTag(_) {
        return function (websites, tags) {
            var filtered = [];
            angular.forEach(websites, function (website) {
                angular.forEach(website.tags, function (tag) {
                    if (_.some(tags, function(t) { return t.id === tag.id; })) {
                        if (filtered.indexOf(website) === -1) {
                            filtered.push(website);
                        }
                    }
                });
            });
            return filtered;
        }
    }
    ByTag.$inject = ["_"];
})();
/**
 * notos.websites
 * FILTER: SearchWebsite
 */
(function () {
    'use strict';

    angular
        .module('notos.websites')
        .filter('SearchWebsite', SearchWebsite);

    /**
     *
     */
    function SearchWebsite(_) {
        return function (websites, filter) {
            var filtered = [];
            var terms = filter.terms === '' ? null : filter.terms.split(' ');
            var tags = filter.tags;
            var levels = filter.levels;

            var tmp = [];

            angular.forEach(websites, function (website) {
                //FIRST filter by Tags AND Levels (AND operator)
                //check tags
                if (tags.length) {
                    angular.forEach(website.tags, function (tag) {
                        //tag selected
                        if (_.some(tags, function (t) {
                                return t.id === tag.id;
                            })) {
                            addUnique(website, tmp);
                        }
                    });
                }
            });

            websites = tags.length ? tmp : websites;
            if (levels.length) {
                tmp = [];
                angular.forEach(websites, function (website) {
                    //check objective levels

                    if (_.any(levels, function (level) {
                            return _.any(website.objectives, function (objective) {
                                return _.some(objective.levels, function (l) {
                                    return l.level > 0 && l.group.id === level.id;
                                })
                            });
                        })) {
                        addUnique(website, tmp);
                    }
                });
            }

            //Within these results filter by terms (OR operator)
            websites = tags.length || levels.length ? tmp : websites;
            if (terms) {
                angular.forEach(websites, function (website) {
                        //check name and description
                        if (_.some(terms, function (t) {
                                return nameContainsTerm(website.name, t) ||
                                    descriptionContainsTerm(website.description, t) ||
                                    objectivesContainsTerm(website.objectives, t);
                            })) {
                            addUnique(website, filtered);
                        }
                    }
                );
            } else {
                filtered = tmp;
            }

            return filtered;

            function addUnique(website, list) {
                if (list.indexOf(website) === -1) {
                    list.push(website);
                }
            }

            function nameContainsTerm(name, term) {
                return _.contains(name.toLowerCase(), term.toLowerCase());
            }

            function descriptionContainsTerm(description, term) {
                return _.contains(description.toLowerCase(), term.toLowerCase());
            }

            function objectivesContainsTerm(objectives, term) {
                return _.some(objectives, function (o) {
                    return _.contains(o.code.toLowerCase(), term.toLowerCase()) ||
                        _.contains(o.name.toLowerCase(), term.toLowerCase());
                });
            }
        }


    }
    SearchWebsite.$inject = ["_"];
})
();
/**
 * notos.websites
 * FACTORY: Website
 */

(function () {
    'use strict';

    angular
        .module('notos.websites')
        .factory('Website', Website);

    /* @ngInject */
    function Website(HTTPCache) {

        var service = {
            full: full,
            getList: getList
        };

        return service;
        ///////////////////

        function getList() {
            return HTTPCache.service('websites').getList();
        }

        function full() {
            return HTTPCache.service('websites').one('full').getList();
        }
    }
    Website.$inject = ["HTTPCache"];
})();
// Include in index.html so that app level exceptions are handled.
// Exclude from testRunner.html which should run exactly what it wants to run
(function() {
    'use strict';

    angular
        .module('blocks.exception')
        .provider('exceptionHandler', exceptionHandlerProvider)
        .config(config);

    /**
     * Must configure the exception handling
     * @return {[type]}
     */
    function exceptionHandlerProvider() {
        /* jshint validthis:true */
        this.config = {
            appErrorPrefix: undefined
        };

        this.configure = function (appErrorPrefix) {
            this.config.appErrorPrefix = appErrorPrefix;
        };

        this.$get = function() {
            return {config: this.config};
        };
    }

    /**
     * Configure by setting an optional string value for appErrorPrefix.
     * Accessible via config.appErrorPrefix (via config value).
     * @param  {[type]} $provide
     * @return {[type]}
     * @ngInject
     */
    function config($provide) {
        $provide.decorator('$exceptionHandler', extendExceptionHandler);
    }
    config.$inject = ["$provide"];

    /**
     * Extend the $exceptionHandler service to also display a toast.
     * @param  {Object} $delegate
     * @param  {Object} exceptionHandler
     * @param  {Object} logger
     * @return {Function} the decorated $exceptionHandler service
     */
    function extendExceptionHandler($delegate, exceptionHandler, logger) {
        return function(exception, cause) {
            var appErrorPrefix = exceptionHandler.config.appErrorPrefix || '';
            var errorData = {exception: exception, cause: cause};
            exception.message = appErrorPrefix + exception.message;
            $delegate(exception, cause);
            /**
             * Could add the error to a service's collection,
             * add errors to $rootScope, log errors to remote web server,
             * or log locally. Or throw hard. It is entirely up to you.
             * throw exception;
             *
             * @example
             *     throw { message: 'error message we added' };
             */
            logger.error(exception.message, errorData);
        };
    }
    extendExceptionHandler.$inject = ["$delegate", "exceptionHandler", "logger"];
})();
/**
 * blocks.exception
 * FACTORY: exception
 */

(function () {
    'use strict';

    angular
        .module('blocks.exception')
        .factory('exception', exception);

    /* @ngInject */
    function exception(logger) {
        var service = {
            catcher: catcher
        };
        return service;

        function catcher(message) {
            return function(reason) {
                logger.error(message, reason);
            };
        }
    }
    exception.$inject = ["logger"];
})();
/**
 * blocks.logger
 * FACTORY: logger
 */

(function () {
    'use strict';

    angular
        .module('blocks.logger')
        .factory('logger', logger);

    logger.$inject = ['$log', 'toastr'];

    function logger($log, toastr) {
        var service = {
            showToasts: true,

            error: error,
            info: info,
            success: success,
            warning: warning,

            removed: removed,
            saved: saved,

            // straight to console; bypass toastr
            log: $log.log
        };

        return service;
        /////////////////////

        function error(message, data, title) {
            toastr.error(message, title);
            $log.error('Fout: ' + message, data);
        }

        function info(message, data, title) {
            toastr.info(message, title);
            $log.info('Info: ' + message, data);
        }

        function success(message, data, title) {
            toastr.success(message, title);
            $log.info('Succes: ' + message, data);
        }

        function warning(message, data, title) {
            toastr.warning(message, title);
            $log.warn('Let op: ' + message, data);
        }

        function removed(message, data, title) {
            toastr.warning(message, title);
            $log.warn('Verwijderd: ' + message, data);
        }

        function saved(message, data, title) {
            toastr.success(message, title);
            $log.info('Bewaard: ' + message, data);
        }
    }
})();
/**
 * notosplus.router
 * FACTORY: routehelper
 */

(function () {
    'use strict';

    angular
        .module('blocks.router')
        .provider('routehelperConfig', routehelperConfig)
        .factory('routehelper', routehelper);

    routehelper.$inject = ['routehelperConfig', '$rootScope', '$state'];

    function routehelperConfig() {
        /* jshint validthis:true */
        this.config = {};

        this.$get = function () {
            return {
                config: this.config
            };
        };
    }

    function routehelper(routehelperConfig, $rootScope, $state) {
        var $urlRouterProvider = routehelperConfig.config.$urlRouterProvider;
        var $stateProvider = routehelperConfig.config.$stateProvider;

        var service = {
            configureStates: configureStates,
            states: states,
            get: get
        };

        init();

        return service;
        //////////////////

        function configureStates(states) {
            states.forEach(function (state) {
                if (state.config.title) {
                    state.config.ncyBreadcrumb = {
                        label: state.config.title.toLowerCase()
                    }
                }

                $stateProvider.state(state.state, state.config);
            });
        }

        function states() {
            return $state.get();
        }

        function get(pattern) {
            var result = null;
            states().forEach(function (state) {
                if (state.name === pattern) {
                    result = state;
                }
            });
            return result;
        }

        function init() {
            updateDocTitle();
            $urlRouterProvider.otherwise('/index/dashboard');
        }

        function updateDocTitle() {
            $rootScope.$on('$stateChangeSuccess',
                function (event, current, previous) {
                    var title = routehelperConfig.config.title + (current.title ? ' | ' + current.title : '');
                    $rootScope.title = title; // data bind to <title>
                    $rootScope.$state = current;
                }
            );
        }

    }
})();
/**
 * notos.widgets
 * DIRECTIVE: ntFa
 */
(function () {
    'use strict';

    angular
        .module('notos.widgets')
        .directive('ntFa', ntFa);

    ntFa.$inject = [];

    function ntFa() {
        var directive = {
            restrict: 'E',
            link: linkFunc
        };

        return directive;
        //////////////////////

        function linkFunc(scope, element, attrs) {
            var i = angular.element('<i class="fa" />');
            var classes = attrs.name.split(' ');

            angular.forEach(classes, function (value) {
                i.addClass('fa-' + value);
            });

            element.replaceWith(i);
        }
    }
})();


/**
 * notos.widgets
 * DIRECTIVE: ntPagination
 */
(function () {
    'use strict';

    angular
        .module('notos.widgets')
        .directive('ntPagination', ntPagination);

    /* @ngInject */
    function ntPagination($compile) {
        var directive = {
            restrict: 'EA',
            scope: {
                totalItems: '=',
                itemsPerPage: '=',
                currentPage: '='
            },
            link: linkFunc,
            controller: PaginateController,
            controllerAs: 'vm',
            bindToController: true // because the scope is isolated
        };

        PaginateController.$inject = ["$scope"];
        return directive;
        //////////////////////

        function linkFunc(scope, element, attrs) {
            var pagination = angular.element('<pagination />')
            pagination.attr('data-boundary-links', true);
            pagination.attr('data-total-items', 'totalItems');
            pagination.attr('data-items-per-page', 'itemsPerPage');
            pagination.attr('data-max-size', 5);
            pagination.attr('data-ng-model', 'currentPage');
            pagination.attr('data-previous-text', '‹');
            pagination.attr('data-next-text', '›');
            pagination.attr('data-first-text', '«');
            pagination.attr('data-last-text', '»');
            pagination.attr('data-ng-hide', 'hide');
            if (attrs['class']) {
                pagination.attr('class', attrs['class']);
            }

            $compile(pagination)(scope);
            element.replaceWith(pagination);
        }

        /* @ngInject */
        function PaginateController($scope) {
            var vm = this;

            vm.hide = false;
            vm.itemsPerPage = 10;
            vm.currentPge = 0;

            $scope.$watch('vm.totalItems', function () {
                vm.hide = (vm.totalItems <= vm.itemsPerPage);
            });
        }
    }
    ntPagination.$inject = ["$compile"];
})();


/**
 * notos.widgets
 * FILTER: offset
 */
(function () {
    'use strict';

    angular
        .module('notos.widgets')
        .filter('offset', filter);


    function filter() {
        return function offset(input, start) {
            if (input) {
                start = parseInt(start, 10);
                return input.slice(start);
            }
            return [];
        };
    }
})();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vdG9zLm1vZHVsZS5qcyIsImNvcmUvY29yZS5tb2R1bGUuanMiLCJkYXNoYm9hcmQvZGFzaGJvYXJkLm1vZHVsZS5qcyIsImRhdGEvZGF0YS5tb2R1bGUuanMiLCJmaWx0ZXIvZmlsdGVyLm1vZHVsZS5qcyIsImxheW91dC9sYXlvdXQubW9kdWxlLmpzIiwid2Vic2l0ZXMvd2Vic2l0ZXMubW9kdWxlLmpzIiwid2lkZ2V0cy93aWRnZXRzLm1vZHVsZS5qcyIsImJsb2Nrcy9leGNlcHRpb24vZXhjZXB0aW9uLm1vZHVsZS5qcyIsImJsb2Nrcy9sb2dnZXIvbG9nZ2VyLm1vZHVsZS5qcyIsImJsb2Nrcy9yb3V0ZXIvcm91dGVyLm1vZHVsZS5qcyIsImNvcmUvYmFzZTY0LmpzIiwiY29yZS9jb21tb24uanMiLCJjb3JlL2NvbmZpZy5qcyIsImNvcmUvY29uc3RhbnRzLmpzIiwiY29yZS9lcnJvci5yb3V0ZXMuanMiLCJkYXNoYm9hcmQvZGFzaGJvYXJkLmNvbnRyb2xsZXIuanMiLCJkYXNoYm9hcmQvZGFzaGJvYXJkLnJvdXRlcy5qcyIsImRhdGEvaGlnaGxpZ2h0LmpzIiwiZGF0YS9yZXN0YW5ndWxhci5jYWNoZS5qcyIsImZpbHRlci9sZXZlbC5qcyIsImZpbHRlci90YWcuanMiLCJsYXlvdXQvc2hlbGwuY29udHJvbGxlci5qcyIsIndlYnNpdGVzL2J5TGV2ZWwuZmlsdGVyLmpzIiwid2Vic2l0ZXMvYnlPYmplY3RpdmUuZmlsdGVyLmpzIiwid2Vic2l0ZXMvYnlUYWcuZmlsdGVyLmpzIiwid2Vic2l0ZXMvc2VhcmNoV2Vic2l0ZS5maWx0ZXIuanMiLCJ3ZWJzaXRlcy93ZWJzaXRlLmpzIiwiYmxvY2tzL2V4Y2VwdGlvbi9leGNlcHRpb24taGFuZGxlci5wcm92aWRlci5qcyIsImJsb2Nrcy9leGNlcHRpb24vZXhjZXB0aW9uLmpzIiwiYmxvY2tzL2xvZ2dlci9sb2dnZXIuanMiLCJibG9ja3Mvcm91dGVyL3JvdXRlaGVscGVyLmpzIiwid2lkZ2V0cy9pY29ucy9udEZhLmpzIiwid2lkZ2V0cy9uYXZpZ2F0aW9uL250UGFnaW5hdGlvbi5qcyIsIndpZGdldHMvbmF2aWdhdGlvbi9vZmZzZXQuanMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBLFNBQUE7O1lBRUE7WUFDQTtZQUNBO1lBQ0E7OztZQUdBO1lBQ0E7WUFDQTs7O0FDZEE7S0FDQSxPQUFBLGNBQUE7O1FBRUEsYUFBQSxjQUFBOzs7UUFHQTtRQUNBO1FBQ0E7OztRQUdBO1FBQ0E7UUFDQTs7QUNiQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUEsbUJBQUE7O0FDSkEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBLGNBQUE7O0FDSkEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBLGdCQUFBOztBQ0pBLENBQUEsWUFBQTtJQUNBOztJQUVBO1NBQ0EsT0FBQSxnQkFBQTs7QUNKQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUEsa0JBQUE7O0FDSkEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBLGlCQUFBOztBQ0pBLENBQUEsWUFBQTtJQUNBOztJQUVBO1NBQ0EsT0FBQSxvQkFBQSxDQUFBOztBQ0pBLENBQUEsWUFBQTtJQUNBOztJQUVBO1NBQ0EsT0FBQSxpQkFBQTs7QUNKQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUEsaUJBQUE7WUFDQTs7Ozs7Ozs7QUNBQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxRQUFBLFVBQUE7OztJQUdBLFNBQUEsU0FBQTtRQUNBLElBQUEsU0FBQTtRQUNBLElBQUEsVUFBQTtZQUNBLFFBQUE7WUFDQSxRQUFBOzs7UUFHQSxPQUFBOzs7UUFHQSxTQUFBLE9BQUEsT0FBQTtZQUNBLElBQUEsU0FBQTtZQUNBLElBQUEsTUFBQSxNQUFBLE9BQUE7WUFDQSxJQUFBLE1BQUEsTUFBQSxNQUFBLE9BQUE7WUFDQSxJQUFBLElBQUE7O1lBRUEsR0FBQTtnQkFDQSxPQUFBLE1BQUEsV0FBQTtnQkFDQSxPQUFBLE1BQUEsV0FBQTtnQkFDQSxPQUFBLE1BQUEsV0FBQTs7Z0JBRUEsT0FBQSxRQUFBO2dCQUNBLE9BQUEsQ0FBQSxDQUFBLE9BQUEsTUFBQSxNQUFBLFFBQUE7Z0JBQ0EsT0FBQSxDQUFBLENBQUEsT0FBQSxPQUFBLE1BQUEsUUFBQTtnQkFDQSxPQUFBLE9BQUE7O2dCQUVBLElBQUEsTUFBQSxPQUFBO29CQUNBLE9BQUEsT0FBQTt1QkFDQSxJQUFBLE1BQUEsT0FBQTtvQkFDQSxPQUFBOzs7Z0JBR0EsU0FBQTtvQkFDQSxPQUFBLE9BQUE7b0JBQ0EsT0FBQSxPQUFBO29CQUNBLE9BQUEsT0FBQTtvQkFDQSxPQUFBLE9BQUE7Z0JBQ0EsT0FBQSxPQUFBLE9BQUE7Z0JBQ0EsT0FBQSxPQUFBLE9BQUEsT0FBQTtxQkFDQSxJQUFBLE1BQUE7O1lBRUEsT0FBQTs7O1FBR0EsU0FBQSxPQUFBLE9BQUE7WUFDQSxJQUFBLFNBQUE7WUFDQSxJQUFBLE1BQUEsTUFBQSxPQUFBO1lBQ0EsSUFBQSxNQUFBLE1BQUEsTUFBQSxPQUFBO1lBQ0EsSUFBQSxJQUFBOzs7WUFHQSxJQUFBLGFBQUE7WUFDQSxJQUFBLFdBQUEsS0FBQSxRQUFBO2dCQUNBLE9BQUEsTUFBQTtvQkFDQTtvQkFDQTs7WUFFQSxRQUFBLE1BQUEsUUFBQSx1QkFBQTs7WUFFQSxHQUFBO2dCQUNBLE9BQUEsT0FBQSxRQUFBLE1BQUEsT0FBQTtnQkFDQSxPQUFBLE9BQUEsUUFBQSxNQUFBLE9BQUE7Z0JBQ0EsT0FBQSxPQUFBLFFBQUEsTUFBQSxPQUFBO2dCQUNBLE9BQUEsT0FBQSxRQUFBLE1BQUEsT0FBQTs7Z0JBRUEsT0FBQSxDQUFBLFFBQUEsTUFBQSxRQUFBO2dCQUNBLE9BQUEsQ0FBQSxDQUFBLE9BQUEsT0FBQSxNQUFBLFFBQUE7Z0JBQ0EsT0FBQSxDQUFBLENBQUEsT0FBQSxNQUFBLEtBQUE7O2dCQUVBLFNBQUEsU0FBQSxPQUFBLGFBQUE7O2dCQUVBLElBQUEsUUFBQSxJQUFBO29CQUNBLFNBQUEsU0FBQSxPQUFBLGFBQUE7O2dCQUVBLElBQUEsUUFBQSxJQUFBO29CQUNBLFNBQUEsU0FBQSxPQUFBLGFBQUE7OztnQkFHQSxPQUFBLE9BQUEsT0FBQTtnQkFDQSxPQUFBLE9BQUEsT0FBQSxPQUFBOztxQkFFQSxJQUFBLE1BQUE7O1lBRUEsT0FBQTs7S0FFQTs7Ozs7OztBQzdGQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxRQUFBLFVBQUE7O0lBRUEsU0FBQSxPQUFBLElBQUEsWUFBQSxVQUFBLFFBQUE7O1FBRUEsSUFBQSxVQUFBOztZQUVBLFlBQUE7WUFDQSxJQUFBO1lBQ0EsVUFBQTs7WUFFQSxVQUFBO1lBQ0EsUUFBQTtZQUNBLGNBQUE7OztRQUdBLE9BQUE7OztRQUdBLFNBQUEsYUFBQTtZQUNBLE9BQUEsV0FBQSxXQUFBLE1BQUEsWUFBQTs7OztRQUlBLFNBQUEsU0FBQSxLQUFBOztZQUVBLE9BQUEsQ0FBQSxhQUFBLEtBQUE7OztRQUdBLFNBQUEsYUFBQSxNQUFBLFlBQUE7WUFDQSxPQUFBLFFBQUEsQ0FBQSxNQUFBLEtBQUEsY0FBQSxRQUFBLFdBQUE7Ozs7O0FDdkNBLENBQUEsWUFBQTtJQUNBOztJQUVBLElBQUEsT0FBQSxRQUFBLE9BQUE7O0lBRUEsS0FBQSxPQUFBOzs7SUFHQSxTQUFBLGFBQUEsUUFBQTtRQUNBLE9BQUEsUUFBQSxVQUFBO1FBQ0EsT0FBQSxRQUFBLGNBQUE7UUFDQSxPQUFBLFFBQUEsY0FBQTtRQUNBLE9BQUEsUUFBQSxnQkFBQTs7OztJQUdBLElBQUEsU0FBQTtRQUNBLGdCQUFBO1FBQ0EsVUFBQTtRQUNBLFNBQUE7OztJQUdBLEtBQUEsTUFBQSxVQUFBOztJQUVBLEtBQUEsT0FBQTs7SUFFQSxLQUFBLElBQUE7O0lBRUEsS0FBQSxJQUFBOzs7O0lBSUEsU0FBQSxVQUFBLG9CQUFBO3VCQUNBLDJCQUFBO3VCQUNBLHFCQUFBOztRQUVBO1FBQ0E7O1FBRUE7O1FBRUEsU0FBQSxtQkFBQTtZQUNBLDBCQUFBLE9BQUEscUJBQUE7WUFDQSwwQkFBQSxPQUFBLGlCQUFBOztZQUVBLDBCQUFBLE9BQUEsUUFBQSxPQUFBOzs7UUFHQSxTQUFBLHNCQUFBO1lBQ0Esb0JBQUEsV0FBQTtnQkFDQSxpQkFBQTtnQkFDQSxVQUFBO2dCQUNBLGlCQUFBOzs7O1FBSUEsU0FBQSx1QkFBQTtZQUNBLElBQUEsVUFBQTs7WUFFQSxvQkFBQSxXQUFBOzs7Ozs7OztJQU9BLFNBQUEsdUJBQUEsWUFBQTtRQUNBLFdBQUEsSUFBQSxxQkFBQSxVQUFBO1lBQ0EsUUFBQSxRQUFBLGNBQUEsUUFBQSxFQUFBLFdBQUEsS0FBQTs7Ozs7O0lBS0EsU0FBQSxPQUFBLFlBQUE7UUFDQSxXQUFBLElBQUEscUJBQUEsU0FBQSxPQUFBO1lBQ0EsTUFBQTtZQUNBLE9BQUEsR0FBQTs7Ozs7OztBQzFFQSxDQUFBLFdBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxTQUFBLFVBQUE7U0FDQSxTQUFBLFVBQUE7U0FDQSxTQUFBLEtBQUEsT0FBQTs7Ozs7QUNMQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxJQUFBOzs7SUFHQSxTQUFBLGFBQUEsYUFBQTtRQUNBLFlBQUEsZ0JBQUE7OzJDQUNBOztJQUVBLFNBQUEsWUFBQTtRQUNBLE9BQUE7WUFDQTtnQkFDQSxPQUFBO2dCQUNBLFFBQUE7b0JBQ0EsVUFBQTtvQkFDQSxLQUFBO29CQUNBLE9BQUE7d0JBQ0EsU0FBQTs0QkFDQSxhQUFBOzs7b0JBR0EsT0FBQTs7O1lBR0E7Z0JBQ0EsT0FBQTtnQkFDQSxRQUFBO29CQUNBLEtBQUE7b0JBQ0EsT0FBQTt3QkFDQSxpQkFBQTs0QkFDQSxhQUFBOzs7b0JBR0EsT0FBQTs7OztLQUlBOzs7Ozs7QUN2Q0EsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBO1NBQ0EsV0FBQSx1QkFBQTs7O0lBR0EsU0FBQSxvQkFBQSxRQUFBLEtBQUEsU0FBQTtpQ0FDQSxxQkFBQTs7UUFFQSxJQUFBLEtBQUE7O1FBRUEsR0FBQSxXQUFBO1FBQ0EsR0FBQSxXQUFBO1FBQ0EsR0FBQSxPQUFBO1FBQ0EsR0FBQSxTQUFBOztRQUVBLEdBQUEsU0FBQTtZQUNBLFFBQUE7WUFDQSxNQUFBO1lBQ0EsT0FBQTs7O1FBR0EsR0FBQSxpQkFBQTtRQUNBLEdBQUEsb0JBQUE7UUFDQSxHQUFBLGVBQUE7UUFDQSxHQUFBLGtCQUFBOztRQUVBLEdBQUEsYUFBQTs7UUFFQSxHQUFBLGVBQUE7UUFDQSxHQUFBLGNBQUE7UUFDQSxHQUFBLGFBQUE7OztRQUdBOzs7UUFHQSxTQUFBLFdBQUE7WUFDQTtZQUNBO1lBQ0EsY0FBQSxLQUFBLFlBQUE7Z0JBQ0E7Ozs7OztRQU1BLFNBQUEsVUFBQTtZQUNBLE9BQUEsSUFBQSxVQUFBLEtBQUE7O1lBRUEsU0FBQSxjQUFBLFVBQUE7Z0JBQ0EsT0FBQSxHQUFBLE9BQUE7Ozs7UUFJQSxTQUFBLFlBQUE7WUFDQSxPQUFBLE1BQUEsVUFBQSxLQUFBOztZQUVBLFNBQUEsZUFBQSxVQUFBO2dCQUNBLE9BQUEsR0FBQSxTQUFBOzs7O1FBSUEsU0FBQSxjQUFBO1lBQ0EsT0FBQSxRQUFBLE9BQUEsS0FBQTs7WUFFQSxTQUFBLGtCQUFBLFVBQUE7Z0JBQ0EsT0FBQSxHQUFBLFdBQUE7Ozs7UUFJQSxTQUFBLGVBQUEsT0FBQTtZQUNBLEdBQUEsT0FBQSxPQUFBLEtBQUE7WUFDQSxJQUFBLFFBQUEsR0FBQSxPQUFBLFFBQUE7WUFDQSxHQUFBLE9BQUEsT0FBQSxPQUFBOzs7UUFHQSxTQUFBLGtCQUFBLE9BQUE7WUFDQSxHQUFBLE9BQUEsS0FBQTtZQUNBLElBQUEsUUFBQSxHQUFBLE9BQUEsT0FBQSxRQUFBO1lBQ0EsR0FBQSxPQUFBLE9BQUEsT0FBQSxPQUFBOzs7UUFHQSxTQUFBLGFBQUEsS0FBQTtZQUNBLEdBQUEsT0FBQSxLQUFBLEtBQUE7WUFDQSxJQUFBLFFBQUEsR0FBQSxLQUFBLFFBQUE7WUFDQSxHQUFBLEtBQUEsT0FBQSxPQUFBOzs7UUFHQSxTQUFBLGdCQUFBLEtBQUE7WUFDQSxHQUFBLEtBQUEsS0FBQTtZQUNBLElBQUEsUUFBQSxHQUFB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QTs7Ozs7Ozs7OztBQ1hBLENBQUEsWUFBQTtJQUNBOztJQUVBO1NBQ0EsT0FBQTtTQUNBLFFBQUEsT0FBQTs7O0lBR0EsU0FBQSxJQUFBLFdBQUE7UUFDQSxJQUFBLFVBQUEsVUFBQSxRQUFBOztRQUVBLE9BQUE7Ozs7Ozs7O0FDWkEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBO1NBQ0EsV0FBQSxtQkFBQTs7O0lBR0EsU0FBQSxrQkFBQTs7UUFFQSxJQUFBLEtBQUE7OztRQUdBOzs7O1FBSUEsU0FBQSxXQUFBOzs7Ozs7Ozs7Ozs7O0FDakJBLENBQUEsWUFBQTtJQUNBOztJQUVBO1NBQ0EsT0FBQTtTQUNBLE9BQUEsV0FBQTs7Ozs7SUFLQSxTQUFBLFFBQUEsR0FBQTtRQUNBLE9BQUEsVUFBQSxVQUFBLFFBQUE7WUFDQSxJQUFBLFdBQUE7WUFDQSxRQUFBLFFBQUEsVUFBQSxVQUFBLFNBQUE7Z0JBQ0EsUUFBQSxRQUFBLFFBQUEsWUFBQSxVQUFBLFdBQUE7b0JBQ0EsUUFBQSxRQUFBLFVBQUEsUUFBQSxTQUFBLE9BQUE7d0JBQ0EsSUFBQSxFQUFBLEtBQUEsUUFBQSxTQUFBLEdBQUEsRUFBQSxPQUFBLE1BQUEsU0FBQSxFQUFBLE9BQUEsTUFBQSxNQUFBLFFBQUE7NEJBQ0EsSUFBQSxNQUFBLFFBQUEsS0FBQSxTQUFBLFFBQUEsYUFBQSxDQUFBLEdBQUE7Z0NBQ0EsU0FBQSxLQUFBOzs7Ozs7O1lBT0EsT0FBQTs7Ozs7Ozs7O0FDekJBLENBQUEsWUFBQTtJQUNBOztJQUVBO1NBQ0EsT0FBQTtTQUNBLE9BQUEsZUFBQTs7Ozs7SUFLQSxTQUFBLGNBQUE7Ozs7Ozs7QUNWQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxPQUFBLFNBQUE7Ozs7O0lBS0EsU0FBQSxNQUFBLEdBQUE7UUFDQSxPQUFBLFVBQUEsVUFBQSxNQUFBO1lBQ0EsSUFBQSxXQUFBO1lBQ0EsUUFBQSxRQUFBLFVBQUEsVUFBQSxTQUFBO2dCQUNBLFFBQUEsUUFBQSxRQUFBLE1BQUEsVUFBQSxLQUFBO29CQUNBLElBQUEsRUFBQSxLQUFBLE1BQUEsU0FBQSxHQUFBLEVBQUEsT0FBQSxFQUFBLE9BQUEsSUFBQSxRQUFBO3dCQUNBLElBQUEsU0FBQSxRQUFBLGFBQUEsQ0FBQSxHQUFBOzRCQUNBLFNBQUEsS0FBQTs7Ozs7WUFLQSxPQUFBOzs7Ozs7Ozs7QUN0QkEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBO1NBQ0EsT0FBQSxpQkFBQTs7Ozs7SUFLQSxTQUFBLGNBQUEsR0FBQTtRQUNBLE9BQUEsVUFBQSxVQUFBLFFBQUE7WUFDQSxJQUFBLFdBQUE7WUFDQSxJQUFBLFFBQUEsT0FBQSxVQUFBLEtBQUEsT0FBQSxPQUFBLE1BQUEsTUFBQTtZQUNBLElBQUEsT0FBQSxPQUFBO1lBQ0EsSUFBQSxTQUFBLE9BQUE7O1lBRUEsSUFBQSxNQUFBOztZQUVBLFFBQUEsUUFBQSxVQUFBLFVBQUEsU0FBQTs7O2dCQUdBLElBQUEsS0FBQSxRQUFBO29CQUNBLFFBQUEsUUFBQSxRQUFBLE1BQUEsVUFBQSxLQUFBOzt3QkFFQSxJQUFBLEVBQUEsS0FBQSxNQUFBLFVBQUEsR0FBQTtnQ0FDQSxPQUFBLEVBQUEsT0FBQSxJQUFBO2dDQUNBOzRCQUNBLFVBQUEsU0FBQTs7Ozs7O1lBTUEsV0FBQSxLQUFBLFNBQUEsTUFBQTtZQUNBLElBQUEsT0FBQSxRQUFBO2dCQUNBLE1BQUE7Z0JBQ0EsUUFBQSxRQUFBLFVBQUEsVUFBQSxTQUFBOzs7b0JBR0EsSUFBQSxFQUFBLElBQUEsUUFBQSxVQUFBLE9BQUE7NEJBQ0EsT0FBQSxFQUFBLElBQUEsUUFBQSxZQUFBLFVBQUEsV0FBQTtnQ0FDQSxPQUFBLEVBQUEsS0FBQSxVQUFBLFFBQUEsVUFBQSxHQUFBO29DQUNBLE9BQUEsRUFBQSxRQUFBLEtBQUEsRUFBQSxNQUFBLE9BQUEsTUFBQTs7OzRCQUdBO3dCQUNBLFVBQUEsU0FBQTs7Ozs7O1lBTUEsV0FBQSxLQUFBLFVBQUEsT0FBQSxTQUFBLE1BQUE7WUFDQSxJQUFBLE9BQUE7Z0JBQ0EsUUFBQSxRQUFBLFVBQUEsVUFBQSxTQUFBOzt3QkFFQSxJQUFBLEVBQUEsS0FBQSxPQUFBLFVBQUEsR0FBQTtnQ0FDQSxPQUFBLGlCQUFBLFFBQUEsTUFBQTtvQ0FDQSx3QkFBQSxRQUFBLGFBQUE7b0NBQ0EsdUJBQUEsUUFBQSxZQUFBO2dDQUNBOzRCQUNBLFVBQUEsU0FBQTs7OzttQkFJQTtnQkFDQSxXQUFBOzs7WUFHQSxPQUFBOztZQUVBLFNBQUEsVUFBQSxTQUFBLE1BQUE7Z0JBQ0EsSUFBQSxLQUFBLFFBQUEsYUFBQSxDQUFBLEdBQUE7b0JBQ0EsS0FBQSxLQUFBOzs7O1lBSUEsU0FBQSxpQkFBQSxNQUFBLE1BQUE7Z0JBQ0EsT0FBQSxFQUFBLFNBQUEsS0FBQSxlQUFBLEtBQUE7OztZQUdBLFNBQUEsd0JBQUEsYUFBQSxNQUFBO2dCQUNBLE9BQUEsRUFBQSxTQUFBLFlBQUEsZUFBQSxLQUFBOzs7WUFHQSxTQUFBLHVCQUFBLFlBQUEsTUFBQTtnQkFDQSxPQUFBLEVBQUEsS0FBQSxZQUFBLFVBQUEsR0FBQTtvQkFDQSxPQUFBLEVBQUEsU0FBQSxFQUFBLEtBQUEsZUFBQSxLQUFBO3dCQUNBLEVBQUEsU0FBQSxFQUFBLEtBQUEsZUFBQSxLQUFBOzs7Ozs7Ozs7Ozs7Ozs7QUN4RkEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBO1NBQ0EsUUFBQSxXQUFBOzs7SUFHQSxTQUFBLFFBQUEsV0FBQTs7UUFFQSxJQUFBLFVBQUE7WUFDQSxNQUFBO1lBQ0EsU0FBQTs7O1FBR0EsT0FBQTs7O1FBR0EsU0FBQSxVQUFBO1lBQ0EsT0FBQSxVQUFBLFFBQUEsWUFBQTs7O1FBR0EsU0FBQSxPQUFBO1lBQ0EsT0FBQSxVQUFBLFFBQUEsWUFBQSxJQUFBLFFBQUE7Ozs7Ozs7QUMxQkEsQ0FBQSxXQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBO1NBQ0EsU0FBQSxvQkFBQTtTQUNBLE9BQUE7Ozs7OztJQU1BLFNBQUEsMkJBQUE7O1FBRUEsS0FBQSxTQUFBO1lBQ0EsZ0JBQUE7OztRQUdBLEtBQUEsWUFBQSxVQUFBLGdCQUFBO1lBQ0EsS0FBQSxPQUFBLGlCQUFBOzs7UUFHQSxLQUFBLE9BQUEsV0FBQTtZQUNBLE9BQUEsQ0FBQSxRQUFBLEtBQUE7Ozs7Ozs7Ozs7O0lBV0EsU0FBQSxPQUFBLFVBQUE7UUFDQSxTQUFBLFVBQUEscUJBQUE7Ozs7Ozs7Ozs7O0lBVUEsU0FBQSx1QkFBQSxXQUFBLGtCQUFBLFFBQUE7UUFDQSxPQUFBLFNBQUEsV0FBQSxPQUFBO1lBQ0EsSUFBQSxpQkFBQSxpQkFBQSxPQUFBLGtCQUFBO1lBQ0EsSUFBQSxZQUFBLENBQUEsV0FBQSxXQUFBLE9BQUE7WUFDQSxVQUFBLFVBQUEsaUJBQUEsVUFBQTtZQUNBLFVBQUEsV0FBQTs7Ozs7Ozs7OztZQVVBLE9BQUEsTUFBQSxVQUFBLFNBQUE7Ozs7Ozs7Ozs7QUN6REEsQ0FBQSxZQUFBO0lBQ0E7O0lBRUE7U0FDQSxPQUFBO1NBQ0EsUUFBQSxhQUFBOzs7SUFHQSxTQUFBLFVBQUEsUUFBQTtRQUNBLElBQUEsVUFBQTtZQUNBLFNBQUE7O1FBRUEsT0FBQTs7UUFFQSxTQUFBLFFBQUEsU0FBQTtZQUNBLE9BQUEsU0FBQSxRQUFBO2dCQUNBLE9BQUEsTUFBQSxTQUFBOzs7Ozs7Ozs7OztBQ2hCQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxRQUFBLFVBQUE7O0lBRUEsT0FBQSxVQUFBLENBQUEsUUFBQTs7SUFFQSxTQUFBLE9BQUEsTUFBQSxRQUFBO1FBQ0EsSUFBQSxVQUFBO1lBQ0EsWUFBQTs7WUFFQSxPQUFBO1lBQ0EsTUFBQTtZQUNBLFNBQUE7WUFDQSxTQUFBOztZQUVBLFNBQUE7WUFDQSxPQUFBOzs7WUFHQSxLQUFBLEtBQUE7OztRQUdBLE9BQUE7OztRQUdBLFNBQUEsTUFBQSxTQUFBLE1BQUEsT0FBQTtZQUNBLE9BQUEsTUFBQSxTQUFBO1lBQ0EsS0FBQSxNQUFBLFdBQUEsU0FBQTs7O1FBR0EsU0FBQSxLQUFBLFNBQUEsTUFBQSxPQUFBO1lBQ0EsT0FBQSxLQUFBLFNBQUE7WUFDQSxLQUFBLEtBQUEsV0FBQSxTQUFBOzs7UUFHQSxTQUFBLFFBQUEs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LHNCQUFBO1lBQ0EsV0FBQSxLQUFBLGtCQUFBO1lBQ0EsV0FBQSxLQUFBLG1CQUFBO1lBQ0EsV0FBQSxLQUFBLGtCQUFBO1lBQ0EsV0FBQSxLQUFBLGdCQUFBO1lBQ0EsSUFBQSxNQUFBLFVBQUE7Z0JBQ0EsV0FBQSxLQUFBLFNBQUEsTUFBQTs7O1lBR0EsU0FBQSxZQUFBO1lBQ0EsUUFBQSxZQUFBOzs7O1FBSUEsU0FBQSxtQkFBQSxRQUFBO1lBQ0EsSUFBQSxLQUFBOztZQUVBLEdBQUEsT0FBQTtZQUNBLEdBQUEsZUFBQTtZQUNBLEdBQUEsYUFBQTs7WUFFQSxPQUFBLE9BQUEsaUJBQUEsWUFBQTtnQkFDQSxHQUFBLFFBQUEsR0FBQSxjQUFBLEdBQUE7Ozs7Ozs7Ozs7OztBQ3REQSxDQUFBLFlBQUE7SUFDQTs7SUFFQTtTQUNBLE9BQUE7U0FDQSxPQUFBLFVBQUE7OztJQUdBLFNBQUEsU0FBQTtRQUNBLE9BQUEsU0FBQSxPQUFBLE9BQUEsT0FBQTtZQUNBLElBQUEsT0FBQTtnQkFDQSxRQUFBLFNBQUEsT0FBQTtnQkFDQSxPQUFBLE1BQUEsTUFBQTs7WUFFQSxPQUFBOzs7S0FHQSIsImZpbGUiOiJhcHAubWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zJywgW1xuICAgICAgICAgICAgLy9zaGFyZWQgbW9kdWxlc1xuICAgICAgICAgICAgJ25vdG9zLmNvcmUnLFxuICAgICAgICAgICAgJ25vdG9zLmxheW91dCcsXG4gICAgICAgICAgICAnbm90b3MuZGF0YScsXG4gICAgICAgICAgICAnbm90b3Mud2lkZ2V0cycsXG5cbiAgICAgICAgICAgIC8vYXBwIG1vZHVsZXNcbiAgICAgICAgICAgICdub3Rvcy5kYXNoYm9hcmQnLFxuICAgICAgICAgICAgJ25vdG9zLmZpbHRlcicsXG4gICAgICAgICAgICAnbm90b3Mud2Vic2l0ZXMnXG4gICAgICAgIF0pO1xufSkoKTsiLCJhbmd1bGFyXG4gICAgLm1vZHVsZSgnbm90b3MuY29yZScsIFtcbiAgICAgICAgLy9Bbmd1bGFyXG4gICAgICAgICduZ0FuaW1hdGUnLCAnbmdTYW5pdGl6ZScsICduZ1Jlc291cmNlJyxcblxuICAgICAgICAvLzNyZCBwYXJ0eVxuICAgICAgICAndWkuYm9vdHN0cmFwJyxcbiAgICAgICAgJ25jeS1hbmd1bGFyLWJyZWFkY3J1bWInLFxuICAgICAgICAncmVzdGFuZ3VsYXInLFxuXG4gICAgICAgIC8vY3Jvc3MgYXBwIG1vZHVsZXNcbiAgICAgICAgJ2Jsb2Nrcy5leGNlcHRpb24nLFxuICAgICAgICAnYmxvY2tzLmxvZ2dlcicsXG4gICAgICAgICdibG9ja3Mucm91dGVyJ1xuICAgIF0pOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvcy5kYXNoYm9hcmQnLCBbXSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvcy5kYXRhJywgW10pO1xufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3MuZmlsdGVyJywgW10pO1xufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3MubGF5b3V0JywgW10pO1xufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3Mud2Vic2l0ZXMnLCBbXSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvcy53aWRnZXRzJywgW10pO1xufSkoKTsiLCIoZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYmxvY2tzLmV4Y2VwdGlvbicsIFsnYmxvY2tzLmxvZ2dlciddKTtcbn0pKCk7IiwiKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2Jsb2Nrcy5sb2dnZXInLCBbXSk7XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdibG9ja3Mucm91dGVyJywgW1xuICAgICAgICAgICAgJ3VpLnJvdXRlcidcbiAgICAgICAgXSk7XG59KSgpOyIsIi8qKlxuICogbm90b3MuY29yZVxuICogRkFDVE9SWTogQmFzZTY0XG4gKi9cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zLmNvcmUnKVxuICAgICAgICAuZmFjdG9yeSgnQmFzZTY0JywgQmFzZTY0KTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIEJhc2U2NCgpIHtcbiAgICAgICAgdmFyIGtleVN0ciA9ICdBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6MDEyMzQ1Njc4OSsvPSc7XG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgICAgICAgZW5jb2RlOiBlbmNvZGUsXG4gICAgICAgICAgICBkZWNvZGU6IGRlY29kZVxuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy9cblxuICAgICAgICBmdW5jdGlvbiBlbmNvZGUoaW5wdXQpIHtcbiAgICAgICAgICAgIHZhciBvdXRwdXQgPSBcIlwiO1xuICAgICAgICAgICAgdmFyIGNocjEsIGNocjIsIGNocjMgPSBcIlwiO1xuICAgICAgICAgICAgdmFyIGVuYzEsIGVuYzIsIGVuYzMsIGVuYzQgPSBcIlwiO1xuICAgICAgICAgICAgdmFyIGkgPSAwO1xuXG4gICAgICAgICAgICBkbyB7XG4gICAgICAgICAgICAgICAgY2hyMSA9IGlucHV0LmNoYXJDb2RlQXQoaSsrKTtcbiAgICAgICAgICAgICAgICBjaHIyID0gaW5wdXQuY2hhckNvZGVBdChpKyspO1xuICAgICAgICAgICAgICAgIGNocjMgPSBpbnB1dC5jaGFyQ29kZUF0KGkrKyk7XG5cbiAgICAgICAgICAgICAgICBlbmMxID0gY2hyMSA+PiAyO1xuICAgICAgICAgICAgICAgIGVuYzIgPSAoKGNocjEgJiAzKSA8PCA0KSB8IChjaHIyID4+IDQpO1xuICAgICAgICAgICAgICAgIGVuYzMgPSAoKGNocjIgJiAxNSkgPDwgMikgfCAoY2hyMyA+PiA2KTtcbiAgICAgICAgICAgICAgICBlbmM0ID0gY2hyMyAmIDYzO1xuXG4gICAgICAgICAgICAgICAgaWYgKGlzTmFOKGNocjIpKSB7XG4gICAgICAgICAgICAgICAgICAgIGVuYzMgPSBlbmM0ID0gNjQ7XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChpc05hTihjaHIzKSkge1xuICAgICAgICAgICAgICAgICAgICBlbmM0ID0gNjQ7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgb3V0cHV0ID0gb3V0cHV0ICtcbiAgICAgICAgICAgICAgICAgICAga2V5U3RyLmNoYXJBdChlbmMxKSArXG4gICAgICAgICAgICAgICAgICAgIGtleVN0ci5jaGFyQXQoZW5jMikgK1xuICAgICAgICAgICAgICAgICAgICBrZXlTdHIuY2hhckF0KGVuYzMpICtcbiAgICAgICAgICAgICAgICAgICAga2V5U3RyLmNoYXJBdChlbmM0KTtcbiAgICAgICAgICAgICAgICBjaHIxID0gY2hyMiA9IGNocjMgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGVuYzEgPSBlbmMyID0gZW5jMyA9IGVuYzQgPSBcIlwiO1xuICAgICAgICAgICAgfSB3aGlsZSAoaSA8IGlucHV0Lmxlbmd0aCk7XG5cbiAgICAgICAgICAgIHJldHVybiBvdXRwdXQ7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBkZWNvZGUoaW5wdXQpIHtcbiAgICAgICAgICAgIHZhciBvdXRwdXQgPSBcIlwiO1xuICAgICAgICAgICAgdmFyIGNocjEsIGNocjIsIGNocjMgPSBcIlwiO1xuICAgICAgICAgICAgdmFyIGVuYzEsIGVuYzIsIGVuYzMsIGVuYzQgPSBcIlwiO1xuICAgICAgICAgICAgdmFyIGkgPSAwO1xuXG4gICAgICAgICAgICAvLyByZW1vdmUgYWxsIGNoYXJhY3RlcnMgdGhhdCBhcmUgbm90IEEtWiwgYS16LCAwLTksICssIC8sIG9yID1cbiAgICAgICAgICAgIHZhciBiYXNlNjR0ZXN0ID0gL1teQS1aYS16MC05XFwrXFwvXFw9XS9nO1xuICAgICAgICAgICAgaWYgKGJhc2U2NHRlc3QuZXhlYyhpbnB1dCkpIHtcbiAgICAgICAgICAgICAgICB3aW5kb3cuYWxlcnQoXCJUaGVyZSB3ZXJlIGludmFsaWQgYmFzZTY0IGNoYXJhY3RlcnMgaW4gdGhlIGlucHV0IHRleHQuXFxuXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIlZhbGlkIGJhc2U2NCBjaGFyYWN0ZXJzIGFyZSBBLVosIGEteiwgMC05LCAnKycsICcvJyxhbmQgJz0nXFxuXCIgK1xuICAgICAgICAgICAgICAgICAgICBcIkV4cGVjdCBlcnJvcnMgaW4gZGVjb2RpbmcuXCIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgaW5wdXQgPSBpbnB1dC5yZXBsYWNlKC9bXkEtWmEtejAtOVxcK1xcL1xcPV0vZywgXCJcIik7XG5cbiAgICAgICAgICAgIGRvIHtcbiAgICAgICAgICAgICAgICBlbmMxID0ga2V5U3RyLmluZGV4T2YoaW5wdXQuY2hhckF0KGkrKykpO1xuICAgICAgICAgICAgICAgIGVuYzIgPSBrZXlTdHIuaW5kZXhPZihpbnB1dC5jaGFyQXQoaSsrKSk7XG4gICAgICAgICAgICAgICAgZW5jMyA9IGtleVN0ci5pbmRleE9mKGlucHV0LmNoYXJBdChpKyspKTtcbiAgICAgICAgICAgICAgICBlbmM0ID0ga2V5U3RyLmluZGV4T2YoaW5wdXQuY2hhckF0KGkrKykpO1xuXG4gICAgICAgICAgICAgICAgY2hyMSA9IChlbmMxIDw8IDIpIHwgKGVuYzIgPj4gNCk7XG4gICAgICAgICAgICAgICAgY2hyMiA9ICgoZW5jMiAmIDE1KSA8PCA0KSB8IChlbmMzID4+IDIpO1xuICAgICAgICAgICAgICAgIGNocjMgPSAoKGVuYzMgJiAzKSA8PCA2KSB8IGVuYzQ7XG5cbiAgICAgICAgICAgICAgICBvdXRwdXQgPSBvdXRwdXQgKyBTdHJpbmcuZnJvbUNoYXJDb2RlKGNocjEpO1xuXG4gICAgICAgICAgICAgICAgaWYgKGVuYzMgIT0gNjQpIHtcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0gb3V0cHV0ICsgU3RyaW5nLmZyb21DaGFyQ29kZShjaHIyKTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgaWYgKGVuYzQgIT0gNjQpIHtcbiAgICAgICAgICAgICAgICAgICAgb3V0cHV0ID0gb3V0cHV0ICsgU3RyaW5nLmZyb21DaGFyQ29kZShjaHIzKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBjaHIxID0gY2hyMiA9IGNocjMgPSBcIlwiO1xuICAgICAgICAgICAgICAgIGVuYzEgPSBlbmMyID0gZW5jMyA9IGVuYzQgPSBcIlwiO1xuXG4gICAgICAgICAgICB9IHdoaWxlIChpIDwgaW5wdXQubGVuZ3RoKTtcblxuICAgICAgICAgICAgcmV0dXJuIG91dHB1dDtcbiAgICAgICAgfVxuICAgIH07XG59KSgpOyIsIi8qKlxuICogbm90b3MuY29yZVxuICogRkFDVE9SWTogY29tbW9uXG4gKi9cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zLmNvcmUnKVxuICAgICAgICAuZmFjdG9yeSgnY29tbW9uJywgY29tbW9uKTtcblxuICAgIGZ1bmN0aW9uIGNvbW1vbigkcSwgJHJvb3RTY29wZSwgJHRpbWVvdXQsIGxvZ2dlcikge1xuXG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgICAgICAgLy8gY29tbW9uIGFuZ3VsYXIgZGVwZW5kZW5jaWVzXG4gICAgICAgICAgICAkYnJvYWRjYXN0OiAkYnJvYWRjYXN0LFxuICAgICAgICAgICAgJHE6ICRxLFxuICAgICAgICAgICAgJHRpbWVvdXQ6ICR0aW1lb3V0LFxuICAgICAgICAgICAgLy8gZ2VuZXJpY1xuICAgICAgICAgICAgaXNOdW1iZXI6IGlzTnVtYmVyLFxuICAgICAgICAgICAgbG9nZ2VyOiBsb2dnZXIsXG4gICAgICAgICAgICB0ZXh0Q29udGFpbnM6IHRleHRDb250YWluc1xuICAgICAgICB9XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIGZ1bmN0aW9uICRicm9hZGNhc3QoKSB7XG4gICAgICAgICAgICByZXR1cm4gJHJvb3RTY29wZS4kYnJvYWRjYXN0LmFwcGx5KCRyb290U2NvcGUsIGFyZ3VtZW50cyk7XG4gICAgICAgIH1cblxuXG4gICAgICAgIGZ1bmN0aW9uIGlzTnVtYmVyKHZhbCkge1xuICAgICAgICAgICAgLy8gbmVnYXRpdmUgb3IgcG9zaXRpdmVcbiAgICAgICAgICAgIHJldHVybiAoL15bLV0/XFxkKyQvKS50ZXN0KHZhbCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiB0ZXh0Q29udGFpbnModGV4dCwgc2VhcmNoVGV4dCkge1xuICAgICAgICAgICAgcmV0dXJuIHRleHQgJiYgLTEgIT09IHRleHQudG9Mb3dlckNhc2UoKS5pbmRleE9mKHNlYXJjaFRleHQudG9Mb3dlckNhc2UoKSk7XG4gICAgICAgIH1cbiAgICB9XG59KSgpOyIsIihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgdmFyIGNvcmUgPSBhbmd1bGFyLm1vZHVsZSgnbm90b3MuY29yZScpO1xuXG4gICAgY29yZS5jb25maWcodG9hc3RyQ29uZmlnKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIHRvYXN0ckNvbmZpZyh0b2FzdHIpIHtcbiAgICAgICAgdG9hc3RyLm9wdGlvbnMudGltZU91dCA9IDQwMDA7XG4gICAgICAgIHRvYXN0ci5vcHRpb25zLmNsb3NlQnV0dG9uID0gdHJ1ZTtcbiAgICAgICAgdG9hc3RyLm9wdGlvbnMucHJvZ3Jlc3NCYXIgPSB0cnVlO1xuICAgICAgICB0b2FzdHIub3B0aW9ucy5wb3NpdGlvbkNsYXNzID0gJ3RvYXN0LWJvdHRvbS1yaWdodCc7XG4gICAgfVxuXG4gICAgdmFyIGNvbmZpZyA9IHtcbiAgICAgICAgYXBwRXJyb3JQcmVmaXg6ICdbRm91dF0gJyxcbiAgICAgICAgYXBwVGl0bGU6ICdub1RvcycsXG4gICAgICAgIHZlcnNpb246ICcxLjAuMCdcbiAgICB9O1xuXG4gICAgY29yZS52YWx1ZSgnY29uZmlnJywgY29uZmlnKTtcblxuICAgIGNvcmUuY29uZmlnKGNvbmZpZ3VyZSk7XG5cbiAgICBjb3JlLnJ1bihhZnRlclZpZXdDb250ZW50TG9hZGVkKTtcblxuICAgIGNvcmUucnVuKHNldDQwNCk7XG5cblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIGNvbmZpZ3VyZSgkdXJsUm91dGVyUHJvdmlkZXIsICRzdGF0ZVByb3ZpZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICByb3V0ZWhlbHBlckNvbmZpZ1Byb3ZpZGVyLCAkYnJlYWRjcnVtYlByb3ZpZGVyLFxuICAgICAgICAgICAgICAgICAgICAgICBSZXN0YW5ndWxhclByb3ZpZGVyKSB7XG5cbiAgICAgICAgY29uZmlndXJlUm91dGluZygpO1xuICAgICAgICBjb25maWd1cmVCcmVhZGNydW1iKCk7XG5cbiAgICAgICAgY29uZmlndXJlUmVzdGFuZ3VsYXIoKTtcblxuICAgICAgICBmdW5jdGlvbiBjb25maWd1cmVSb3V0aW5nKCkge1xuICAgICAgICAgICAgcm91dGVoZWxwZXJDb25maWdQcm92aWRlci5jb25maWcuJHVybFJvdXRlclByb3ZpZGVyID0gJHVybFJvdXRlclByb3ZpZGVyO1xuICAgICAgICAgICAgcm91dGVoZWxwZXJDb25maWdQcm92aWRlci5jb25maWcuJHN0YXRlUHJvdmlkZXIgPSAkc3RhdGVQcm92aWRlcjtcblxuICAgICAgICAgICAgcm91dGVoZWxwZXJDb25maWdQcm92aWRlci5jb25maWcudGl0bGUgPSBjb25maWcuYXBwVGl0bGU7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjb25maWd1cmVCcmVhZGNydW1iKCkge1xuICAgICAgICAgICAgJGJyZWFkY3J1bWJQcm92aWRlci5zZXRPcHRpb25zKHtcbiAgICAgICAgICAgICAgICBwcmVmaXhTdGF0ZU5hbWU6ICdpbmRleCcsXG4gICAgICAgICAgICAgICAgdGVtcGxhdGU6ICdib290c3RyYXAzJyxcbiAgICAgICAgICAgICAgICBpbmNsdWRlQWJzdHJhY3Q6IHRydWVcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gY29uZmlndXJlUmVzdGFuZ3VsYXIoKSB7XG4gICAgICAgICAgICB2YXIgYmFzZVVybCA9ICcvYXBpJztcblxuICAgICAgICAgICAgUmVzdGFuZ3VsYXJQcm92aWRlci5zZXRCYXNlVXJsKGJhc2VVcmwpO1xuICAgICAgICB9XG5cblxuICAgIH1cblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIGFmdGVyVmlld0NvbnRlbnRMb2FkZWQoJHJvb3RTY29wZSkge1xuICAgICAgICAkcm9vdFNjb3BlLiRvbignJHZpZXdDb250ZW50TG9hZGVkJyxmdW5jdGlvbigpe1xuICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KCdodG1sLCBib2R5JykuYW5pbWF0ZSh7IHNjcm9sbFRvcDogMCB9LCAyMDApO1xuICAgICAgICB9KVxuICAgIH1cblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIHNldDQwNCgkcm9vdFNjb3BlKSB7XG4gICAgICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VFcnJvcicsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgICAgICAgJHN0YXRlLmdvKCdlcnJvci40MDQnKTtcbiAgICAgICAgfSk7XG4gICAgfVxuXG59KSgpOyIsIi8qIGdsb2JhbCB0b2FzdHI6ZmFsc2UsIG1vbWVudDpmYWxzZSAqL1xuKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3MuY29yZScpXG4gICAgICAgIC5jb25zdGFudCgndG9hc3RyJywgdG9hc3RyKVxuICAgICAgICAuY29uc3RhbnQoJ21vbWVudCcsIG1vbWVudClcbiAgICAgICAgLmNvbnN0YW50KCdfJywgd2luZG93Ll8pO1xufSkoKTsiLCIvKipcbiAqIFJPVVRFUzogbm90b3MuY29yZVxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3MuY29yZScpXG4gICAgICAgIC5ydW4oY29uZmlnUm91dGVzKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIGNvbmZpZ1JvdXRlcyhyb3V0ZWhlbHBlcikge1xuICAgICAgICByb3V0ZWhlbHBlci5jb25maWd1cmVTdGF0ZXMoZ2V0U3RhdGVzKCkpO1xuICAgIH07XG5cbiAgICBmdW5jdGlvbiBnZXRTdGF0ZXMoKSB7XG4gICAgICAgIHJldHVybiBbXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgc3RhdGU6ICdlcnJvcicsXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgICAgIGFic3RyYWN0OiB0cnVlLFxuICAgICAgICAgICAgICAgICAgICB1cmw6ICcvZXJyb3InLFxuICAgICAgICAgICAgICAgICAgICB2aWV3czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ21haW5AJzoge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRlbXBsYXRlVXJsOiAnanMvbW9kdWxlcy9sYXlvdXQvbWFpbi5odG1sJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ0ZvdXQnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ2Vycm9yLjQwNCcsXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJy80MDQnLFxuICAgICAgICAgICAgICAgICAgICB2aWV3czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ2NvbnRlbnRAZXJyb3InOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdqcy9tb2R1bGVzL2NvcmUvZXJyb3JzLzQwNC5odG1sJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgfSxcbiAgICAgICAgICAgICAgICAgICAgdGl0bGU6ICdQYWdpbmEgbmlldCBnZXZvbmRlbidcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG4gICAgfTtcbn0pKCk7IiwiLyoqXG4gKiBub3Rvcy5kYXNoYm9hcmRcbiAqIENPTlRST0xMRVI6IERhc2hib2FyZENvbnRyb2xsZXJcbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zLmRhc2hib2FyZCcpXG4gICAgICAgIC5jb250cm9sbGVyKCdEYXNoYm9hcmRDb250cm9sbGVyJywgRGFzaGJvYXJkQ29udHJvbGxlcik7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBEYXNoYm9hcmRDb250cm9sbGVyKCRzY29wZSwgVGFnLCBXZWJzaXRlLCBMZXZlbCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIFNlYXJjaFdlYnNpdGVGaWx0ZXIpIHtcbiAgICAgICAgLypqc2hpbnQgdmFsaWR0aGlzOiB0cnVlICovXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgdm0ud2Vic2l0ZXMgPSBbXTtcbiAgICAgICAgdm0uZmlsdGVyZWQgPSBbXTtcbiAgICAgICAgdm0udGFncyA9IFtdO1xuICAgICAgICB2bS5sZXZlbHMgPSBbXTtcblxuICAgICAgICB2bS5maWx0ZXIgPSB7XG4gICAgICAgICAgICBsZXZlbHM6IFtdLFxuICAgICAgICAgICAgdGFnczogW10sXG4gICAgICAgICAgICB0ZXJtczogJydcbiAgICAgICAgfVxuXG4gICAgICAgIHZtLmFkZExldmVsRmlsdGVyID0gYWRkTGV2ZWxGaWx0ZXI7XG4gICAgICAgIHZtLnJlbW92ZUxldmVsRmlsdGVyID0gcmVtb3ZlTGV2ZWxGaWx0ZXI7XG4gICAgICAgIHZtLmFkZFRhZ0ZpbHRlciA9IGFkZFRhZ0ZpbHRlcjtcbiAgICAgICAgdm0ucmVtb3ZlVGFnRmlsdGVyID0gcmVtb3ZlVGFnRmlsdGVyO1xuXG4gICAgICAgIHZtLmZpbHRlckZsYWcgPSBmYWxzZTtcblxuICAgICAgICB2bS5pdGVtc1BlclBhZ2UgPSAxMDtcbiAgICAgICAgdm0uY3VycmVudFBhZ2UgPSAxO1xuICAgICAgICB2bS50b3RhbEl0ZW1zID0gMDtcblxuXG4gICAgICAgIGFjdGl2YXRlKCk7XG4gICAgICAgIC8vLy8vLy8vLy8vXG5cbiAgICAgICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICAgICAgICBnZXRUYWdzKCk7XG4gICAgICAgICAgICBnZXRMZXZlbHMoKTtcbiAgICAgICAgICAgIGdldFdlYnNpdGVzKCkudGhlbihmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgc2V0RmlsdGVyRmxhZygpO1xuICAgICAgICAgICAgfSk7XG5cblxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0VGFncygpIHtcbiAgICAgICAgICAgIHJldHVybiBUYWcuZ2V0TGlzdCgpLnRoZW4odGFnc0NvbXBsZXRlZCk7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIHRhZ3NDb21wbGV0ZWQocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdm0udGFncyA9IHJlc3BvbnNlO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0TGV2ZWxzKCkge1xuICAgICAgICAgICAgcmV0dXJuIExldmVsLmdldExpc3QoKS50aGVuKGxldmVsQ29tcGxldGVkKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gbGV2ZWxDb21wbGV0ZWQocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdm0ubGV2ZWxzID0gcmVzcG9uc2U7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRXZWJzaXRlcygpIHtcbiAgICAgICAgICAgIHJldHVybiBXZWJzaXRlLmZ1bGwoKS50aGVuKHdlYnNpdGVzQ29tcGxldGVkKTtcblxuICAgICAgICAgICAgZnVuY3Rpb24gd2Vic2l0ZXNDb21wbGV0ZWQocmVzcG9uc2UpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gdm0ud2Vic2l0ZXMgPSByZXNwb25zZTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGFkZExldmVsRmlsdGVyKGxldmVsKSB7XG4gICAgICAgICAgICB2bS5maWx0ZXIubGV2ZWxzLnB1c2gobGV2ZWwpO1xuICAgICAgICAgICAgdmFyIGluZGV4ID0gdm0ubGV2ZWxzLmluZGV4T2YobGV2ZWwpO1xuICAgICAgICAgICAgdm0ubGV2ZWxzLnNwbGljZShpbmRleCwgMSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiByZW1vdmVMZXZlbEZpbHRlcihsZXZlbCkge1xuICAgICAgICAgICAgdm0ubGV2ZWxzLnB1c2gobGV2ZWwpO1xuICAgICAgICAgICAgdmFyIGluZGV4ID0gdm0uZmlsdGVyLmxldmVscy5pbmRleE9mKGxldmVsKTtcbiAgICAgICAgICAgIHZtLmZpbHRlci5sZXZlbHMuc3BsaWNlKGluZGV4LCAxKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGFkZFRhZ0ZpbHRlcih0YWcpIHtcbiAgICAgICAgICAgIHZtLmZpbHRlci50YWdzLnB1c2godGFnKTtcbiAgICAgICAgICAgIHZhciBpbmRleCA9IHZtLnRhZ3MuaW5kZXhPZih0YWcpO1xuICAgICAgICAgICAgdm0udGFncy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gcmVtb3ZlVGFnRmlsdGVyKHRhZykge1xuICAgICAgICAgICAgdm0udGFncy5wdXNoKHRhZyk7XG4gICAgICAgICAgICB2YXIgaW5kZXggPSB2bS5maWx0ZXIudGFncy5pbmRleE9mKHRhZyk7XG4gICAgICAgICAgICB2bS5maWx0ZXIudGFncy5zcGxpY2UoaW5kZXgsIDEpO1xuICAgICAgICB9XG5cbiAgICAgICAgJHNjb3BlLiR3YXRjaCgndm0uZmlsdGVyJywgZnVuY3Rpb24gKHRhZ3MpIHtcbiAgICAgICAgICAgIGlmICh2bS53ZWJzaXRlcy5sZW5ndGgpIHtcbiAgICAgICAgICAgICAgICB2YXIgd2Vic2l0ZXMgPSBbXTtcbiAgICAgICAgICAgICAgICB2bS5maWx0ZXJlZCA9IFNlYXJjaFdlYnNpdGVGaWx0ZXIodm0ud2Vic2l0ZXMsIHZtLmZpbHRlcik7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBzZXRGaWx0ZXJGbGFnKCk7XG4gICAgICAgIH0sIHRydWUpO1xuXG4gICAgICAgICRzY29wZS4kd2F0Y2hHcm91cChbJ3ZtLmN1cnJlbnRQYWdlJywgJ3ZtLnRvdGFsSXRlbXMnLCAndm0uaXRlbXNQZXJQYWdlJ10sIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgIHNldFBhZ2luYXRpb25UZXh0KCk7XG4gICAgICAgIH0pO1xuXG5cbiAgICAgICAgZnVuY3Rpb24gc2V0RmlsdGVyRmxhZygpIHtcbiAgICAgICAgICAgIHZtLmZpbHRlckZsYWcgPSB2bS5maWx0ZXIubGV2ZWxzLmxlbmd0aCB8fFxuICAgICAgICAgICAgICAgIHZtLmZpbHRlci50YWdzLmxlbmd0aCB8fFxuICAgICAgICAgICAgICAgIHZtLmZpbHRlci50ZXJtcztcblxuICAgICAgICAgICAgaWYgKCF2bS5maWx0ZXJGbGFnKSB7XG4gICAgICAgICAgICAgICAgdm0uZmlsdGVyZWQgPSB2bS53ZWJzaXRlcztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHZtLnRvdGFsSXRlbXMgPSB2bS5maWx0ZXJlZC5sZW5ndGg7XG5cbiAgICAgICAgICAgIHNldFBhZ2luYXRpb25UZXh0KCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzZXRQYWdpbmF0aW9uVGV4dCgpIHtcbiAgICAgICAgICAgIHZhciB0b3RhbCA9IHZtLmZpbHRlcmVkLmxlbmd0aDtcbiAgICAgICAgICAgIHZhciBmbG9vciA9ICgodm0uY3VycmVudFBhZ2UgLSAxKSAqIHZtLml0ZW1zUGVyUGFnZSkgKyAxO1xuICAgICAgICAgICAgdmFyIGNlaWwgPSBmbG9vciArICh2bS5pdGVtc1BlclBhZ2UgLSAxKTtcbiAgICAgICAgICAgIGlmIChjZWlsID4gdG90YWwpIHtcbiAgICAgICAgICAgICAgICBjZWlsID0gdG90YWw7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGlmICh0b3RhbCA+IDAgJiYgdG90YWwgPiB2bS5pdGVtc1BlclBhZ2UpIHtcbiAgICAgICAgICAgICAgICB2bS5wYWdpbmF0aW9uVGV4dCA9ICdUb29udCAnICsgZmxvb3IgK1xuICAgICAgICAgICAgICAgICAgICAodG90YWwgPiAxID8gJyAtICcgKyAnICcgKyBjZWlsIDogJycpICtcbiAgICAgICAgICAgICAgICAgICAgJyAodmFuICcgKyB0b3RhbCArICcgd2Vic2l0ZXMpJztcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgICAgdm0ucGFnaW5hdGlvblRleHQgPSAnJztcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbn0pKCk7IiwiLyoqXG4gKiBST1VURVM6IG5vdG9zLmRhc2hib2FyZFxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3MuZGFzaGJvYXJkJylcbiAgICAgICAgLnJ1bihjb25maWdSb3V0ZXMpO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gY29uZmlnUm91dGVzKHJvdXRlaGVscGVyKSB7XG4gICAgICAgIHJvdXRlaGVscGVyLmNvbmZpZ3VyZVN0YXRlcyhnZXRTdGF0ZXMoKSk7XG4gICAgfTtcblxuICAgIGZ1bmN0aW9uIGdldFN0YXRlcygpIHtcbiAgICAgICAgcmV0dXJuIFtcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ2luZGV4JyxcbiAgICAgICAgICAgICAgICBjb25maWc6IHtcbiAgICAgICAgICAgICAgICAgICAgYWJzdHJhY3Q6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9pbmRleCcsXG4gICAgICAgICAgICAgICAgICAgIHZpZXdzOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAnbWFpbkAnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdqcy9tb2R1bGVzL2xheW91dC9tYWluLmh0bWwnXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICAgICAgICAgIHRpdGxlOiAnc3RhcnQnXG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICBzdGF0ZTogJ2luZGV4LmRhc2hib2FyZCcsXG4gICAgICAgICAgICAgICAgY29uZmlnOiB7XG4gICAgICAgICAgICAgICAgICAgIHVybDogJy9kYXNoYm9hcmQnLFxuICAgICAgICAgICAgICAgICAgICB2aWV3czoge1xuICAgICAgICAgICAgICAgICAgICAgICAgJ2NvbnRlbnRAaW5kZXgnOiB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGVtcGxhdGVVcmw6ICdqcy9tb2R1bGVzL2Rhc2hib2FyZC9kYXNoYm9hcmQuaHRtbCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgY29udHJvbGxlcjogJ0Rhc2hib2FyZENvbnRyb2xsZXInLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJ1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9LFxuICAgICAgICAgICAgICAgICAgICB0aXRsZTogJ0Rhc2hib2FyZCdcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIF07XG4gICAgfTtcbn0pKCk7IiwiLyoqXG4gKiBub3Rvcy5kYXRhXG4gKiBGSUxURVI6IEhpZ2hsaWdodFxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3MuZGF0YScpXG4gICAgICAgIC5maWx0ZXIoJ0hpZ2hsaWdodCcsIEhpZ2hsaWdodCk7XG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIEhpZ2hsaWdodCgkc2NlKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAoc3RyLCB0ZXJtc1RvSGlnaGxpZ2h0KSB7XG4gICAgICAgICAgICBpZiAodGVybXNUb0hpZ2hsaWdodCA9PT0gJycpIHtcbiAgICAgICAgICAgICAgICByZXR1cm4gJHNjZS50cnVzdEFzSHRtbChzdHIpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgLy8gU29ydCB0ZXJtcyBieSBsZW5ndGhcbiAgICAgICAgICAgIHRlcm1zVG9IaWdobGlnaHQgPSB0ZXJtc1RvSGlnaGxpZ2h0LnNwbGl0KFwiIFwiKTtcbiAgICAgICAgICAgIHRlcm1zVG9IaWdobGlnaHQuc29ydChmdW5jdGlvbiAoYSwgYikge1xuICAgICAgICAgICAgICAgIHJldHVybiBiLmxlbmd0aCAtIGEubGVuZ3RoO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIFJlZ2V4IHRvIHNpbXVsdGFuZW91c2x5IHJlcGxhY2UgdGVybXNcbiAgICAgICAgICAgIHZhciByZWdleCA9IG5ldyBSZWdFeHAoJyg/ITxbXj5dKj8+KScgKyB0ZXJtc1RvSGlnaGxpZ2h0LmpvaW4oJ3wnKSArICcoPyFbXjxdKj88L1tePl0qPz4pJywgJ2dpJyk7XG4gICAgICAgICAgICByZXR1cm4gJHNjZS50cnVzdEFzSHRtbChzdHIucmVwbGFjZShyZWdleCwgJzxzcGFuIGNsYXNzPVwibWF0Y2hcIj4kJjwvc3Bhbj4nKSk7XG4gICAgICAgIH07XG4gICAgfVxuXG59KSgpOyIsIi8qKlxuICogbm90b3MuZGF0YVxuICogRkFDVE9SWTogSFRUUENhY2hlXG4gKi9cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zLmRhdGEnKVxuICAgICAgICAuZmFjdG9yeSgnSFRUUENhY2hlJywgSFRUUENhY2hlKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIEhUVFBDYWNoZShSZXN0YW5ndWxhciwgJGNhY2hlRmFjdG9yeSkge1xuICAgICAgICB2YXIgY2FjaGU7XG4gICAgICAgIGNhY2hlID0gJGNhY2hlRmFjdG9yeSgnaHR0cCcpO1xuXG4gICAgICAgIHJldHVybiBSZXN0YW5ndWxhci53aXRoQ29uZmlnKGZ1bmN0aW9uIChSZXN0YW5ndWxhckNvbmZpZ3VyZXIpIHtcbiAgICAgICAgICAgIFJlc3Rhbmd1bGFyQ29uZmlndXJlci5zZXREZWZhdWx0SHR0cEZpZWxkcyh7Y2FjaGU6IGNhY2hlfSk7XG4gICAgICAgICAgICBSZXN0YW5ndWxhckNvbmZpZ3VyZXIuc2V0UmVzcG9uc2VJbnRlcmNlcHRvcihmdW5jdGlvbiAocmVzcG9uc2UsIG9wZXJhdGlvbikge1xuICAgICAgICAgICAgICAgIGlmIChvcGVyYXRpb24gPT09ICdwdXQnIHx8IG9wZXJhdGlvbiA9PT0gJ3Bvc3QnIHx8IG9wZXJhdGlvbiA9PT0gJ2RlbGV0ZScpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FjaGUucmVtb3ZlQWxsKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiByZXNwb25zZTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAvLyBDdXN0b20gR2xvYmFsIE1ldGhvZChzKSBmb3IgUmVzdGFuZ3VsYXJpemVkIEVsZW1lbnRzLlxuICAgICAgICAgICAgUmVzdGFuZ3VsYXJDb25maWd1cmVyLnNldE9uRWxlbVJlc3Rhbmd1bGFyaXplZChmdW5jdGlvbihlbGVtLCBpc0NvbGxlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICBlbGVtLmNsZWFyQ2FjaGUgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICAgICAgY2FjaGUucmVtb3ZlQWxsKCk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIHJldHVybiBlbGVtO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0pO1xuICAgIH1cbn0pKCk7IiwiLyoqXG4gKiBub3Rvcy5maWx0ZXJcbiAqIEZBQ1RPUlk6IExldmVsXG4gKi9cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zLmZpbHRlcicpXG4gICAgICAgIC5mYWN0b3J5KCdMZXZlbCcsIExldmVsKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIExldmVsKEhUVFBDYWNoZSkge1xuICAgICAgICB2YXIgc2VydmljZSA9IEhUVFBDYWNoZS5zZXJ2aWNlKCdncm91cCcpLm9uZSgnbGV2ZWxzJyk7XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG5cbiAgICB9XG59KSgpOyIsIi8qKlxuICogbm90b3MuZmlsdGVyXG4gKiBGQUNUT1JZOiBUYWdcbiAqL1xuXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3MuZmlsdGVyJylcbiAgICAgICAgLmZhY3RvcnkoJ1RhZycsIFRhZyk7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBUYWcoSFRUUENhY2hlKSB7XG4gICAgICAgIHZhciBzZXJ2aWNlID0gSFRUUENhY2hlLnNlcnZpY2UoJ3RhZ3MnKTtcblxuICAgICAgICByZXR1cm4gc2VydmljZTtcbiAgICB9XG59KSgpOyIsIi8qKlxuICogbm90b3MubGF5b3V0XG4gKiBDT05UUk9MTEVSOiBTaGVsbENvbnRyb2xsZXJcbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zLmxheW91dCcpXG4gICAgICAgIC5jb250cm9sbGVyKCdTaGVsbENvbnRyb2xsZXInLCBTaGVsbENvbnRyb2xsZXIpO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gU2hlbGxDb250cm9sbGVyKCkge1xuICAgICAgICAvKmpzaGludCB2YWxpZHRoaXM6IHRydWUgKi9cbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuXG4gICAgICAgIGFjdGl2YXRlKCk7XG4gICAgICAgIC8vLy8vLy8vLy8vLy9cblxuXG4gICAgICAgIGZ1bmN0aW9uIGFjdGl2YXRlKCkge1xuXG4gICAgICAgIH1cblxuXG4gICAgfVxuXG5cbn0pKCk7IiwiLyoqXG4gKiBub3Rvcy53ZWJzaXRlc1xuICogRklMVEVSOiBCeUxldmVsXG4gKi9cbihmdW5jdGlvbiAoKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdub3Rvcy53ZWJzaXRlcycpXG4gICAgICAgIC5maWx0ZXIoJ0J5TGV2ZWwnLCBCeUxldmVsKTtcblxuICAgIC8qKlxuICAgICAqXG4gICAgICovXG4gICAgZnVuY3Rpb24gQnlMZXZlbChfKSB7XG4gICAgICAgIHJldHVybiBmdW5jdGlvbiAod2Vic2l0ZXMsIGxldmVscykge1xuICAgICAgICAgICAgdmFyIGZpbHRlcmVkID0gW107XG4gICAgICAgICAgICBhbmd1bGFyLmZvckVhY2god2Vic2l0ZXMsIGZ1bmN0aW9uICh3ZWJzaXRlKSB7XG4gICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHdlYnNpdGUub2JqZWN0aXZlcywgZnVuY3Rpb24gKG9iamVjdGl2ZSkge1xuICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2gob2JqZWN0aXZlLmxldmVscywgZnVuY3Rpb24obGV2ZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChfLnNvbWUobGV2ZWxzLCBmdW5jdGlvbihsKSB7IHJldHVybiBsZXZlbC5ncm91cCAmJiBsLmlkID09PSBsZXZlbC5ncm91cC5pZDsgfSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAobGV2ZWwubGV2ZWwgPiAwICYmIGZpbHRlcmVkLmluZGV4T2Yod2Vic2l0ZSkgPT09IC0xKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcmVkLnB1c2god2Vic2l0ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICByZXR1cm4gZmlsdGVyZWQ7XG4gICAgICAgIH1cbiAgICB9XG59KSgpOyIsIi8qKlxuICogbm90b3Mud2Vic2l0ZXNcbiAqIEZJTFRFUjogQnlPYmplY3RpdmVcbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zLndlYnNpdGVzJylcbiAgICAgICAgLmZpbHRlcignQnlPYmplY3RpdmUnLCBCeU9iamVjdGl2ZSk7XG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIEJ5T2JqZWN0aXZlKCkge1xuICAgIH1cbn0pKCk7IiwiLyoqXG4gKiBub3Rvcy53ZWJzaXRlc1xuICogRklMVEVSOiBUYWdGaWx0ZXJcbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zLndlYnNpdGVzJylcbiAgICAgICAgLmZpbHRlcignQnlUYWcnLCBCeVRhZyk7XG5cbiAgICAvKipcbiAgICAgKlxuICAgICAqL1xuICAgIGZ1bmN0aW9uIEJ5VGFnKF8pIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh3ZWJzaXRlcywgdGFncykge1xuICAgICAgICAgICAgdmFyIGZpbHRlcmVkID0gW107XG4gICAgICAgICAgICBhbmd1bGFyLmZvckVhY2god2Vic2l0ZXMsIGZ1bmN0aW9uICh3ZWJzaXRlKSB7XG4gICAgICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHdlYnNpdGUudGFncywgZnVuY3Rpb24gKHRhZykge1xuICAgICAgICAgICAgICAgICAgICBpZiAoXy5zb21lKHRhZ3MsIGZ1bmN0aW9uKHQpIHsgcmV0dXJuIHQuaWQgPT09IHRhZy5pZDsgfSkpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChmaWx0ZXJlZC5pbmRleE9mKHdlYnNpdGUpID09PSAtMSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGZpbHRlcmVkLnB1c2god2Vic2l0ZSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIGZpbHRlcmVkO1xuICAgICAgICB9XG4gICAgfVxufSkoKTsiLCIvKipcbiAqIG5vdG9zLndlYnNpdGVzXG4gKiBGSUxURVI6IFNlYXJjaFdlYnNpdGVcbiAqL1xuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ25vdG9zLndlYnNpdGVzJylcbiAgICAgICAgLmZpbHRlcignU2VhcmNoV2Vic2l0ZScsIFNlYXJjaFdlYnNpdGUpO1xuXG4gICAgLyoqXG4gICAgICpcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBTZWFyY2hXZWJzaXRlKF8pIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uICh3ZWJzaXRlcywgZmlsdGVyKSB7XG4gICAgICAgICAgICB2YXIgZmlsdGVyZWQgPSBbXTtcbiAgICAgICAgICAgIHZhciB0ZXJtcyA9IGZpbHRlci50ZXJtcyA9PT0gJycgPyBudWxsIDogZmlsdGVyLnRlcm1zLnNwbGl0KCcgJyk7XG4gICAgICAgICAgICB2YXIgdGFncyA9IGZpbHRlci50YWdzO1xuICAgICAgICAgICAgdmFyIGxldmVscyA9IGZpbHRlci5sZXZlbHM7XG5cbiAgICAgICAgICAgIHZhciB0bXAgPSBbXTtcblxuICAgICAgICAgICAgYW5ndWxhci5mb3JFYWNoKHdlYnNpdGVzLCBmdW5jdGlvbiAod2Vic2l0ZSkge1xuICAgICAgICAgICAgICAgIC8vRklSU1QgZmlsdGVyIGJ5IFRhZ3MgQU5EIExldmVscyAoQU5EIG9wZXJhdG9yKVxuICAgICAgICAgICAgICAgIC8vY2hlY2sgdGFnc1xuICAgICAgICAgICAgICAgIGlmICh0YWdzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2god2Vic2l0ZS50YWdzLCBmdW5jdGlvbiAodGFnKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL3RhZyBzZWxlY3RlZFxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKF8uc29tZSh0YWdzLCBmdW5jdGlvbiAodCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gdC5pZCA9PT0gdGFnLmlkO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkVW5pcXVlKHdlYnNpdGUsIHRtcCk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB3ZWJzaXRlcyA9IHRhZ3MubGVuZ3RoID8gdG1wIDogd2Vic2l0ZXM7XG4gICAgICAgICAgICBpZiAobGV2ZWxzLmxlbmd0aCkge1xuICAgICAgICAgICAgICAgIHRtcCA9IFtdO1xuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaCh3ZWJzaXRlcywgZnVuY3Rpb24gKHdlYnNpdGUpIHtcbiAgICAgICAgICAgICAgICAgICAgLy9jaGVjayBvYmplY3RpdmUgbGV2ZWxzXG5cbiAgICAgICAgICAgICAgICAgICAgaWYgKF8uYW55KGxldmVscywgZnVuY3Rpb24gKGxldmVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF8uYW55KHdlYnNpdGUub2JqZWN0aXZlcywgZnVuY3Rpb24gKG9iamVjdGl2ZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gXy5zb21lKG9iamVjdGl2ZS5sZXZlbHMsIGZ1bmN0aW9uIChsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbC5sZXZlbCA+IDAgJiYgbC5ncm91cC5pZCA9PT0gbGV2ZWwuaWQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICAgICAgICAgICAgICB9KSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgYWRkVW5pcXVlKHdlYnNpdGUsIHRtcCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgLy9XaXRoaW4gdGhlc2UgcmVzdWx0cyBmaWx0ZXIgYnkgdGVybXMgKE9SIG9wZXJhdG9yKVxuICAgICAgICAgICAgd2Vic2l0ZXMgPSB0YWdzLmxlbmd0aCB8fCBsZXZlbHMubGVuZ3RoID8gdG1wIDogd2Vic2l0ZXM7XG4gICAgICAgICAgICBpZiAodGVybXMpIHtcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmZvckVhY2god2Vic2l0ZXMsIGZ1bmN0aW9uICh3ZWJzaXRlKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAvL2NoZWNrIG5hbWUgYW5kIGRlc2NyaXB0aW9uXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAoXy5zb21lKHRlcm1zLCBmdW5jdGlvbiAodCkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICByZXR1cm4gbmFtZUNvbnRhaW5zVGVybSh3ZWJzaXRlLm5hbWUsIHQpIHx8XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBkZXNjcmlwdGlvbkNvbnRhaW5zVGVybSh3ZWJzaXRlLmRlc2NyaXB0aW9uLCB0KSB8fFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgb2JqZWN0aXZlc0NvbnRhaW5zVGVybSh3ZWJzaXRlLm9iamVjdGl2ZXMsIHQpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYWRkVW5pcXVlKHdlYnNpdGUsIGZpbHRlcmVkKTtcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgICAgIGZpbHRlcmVkID0gdG1wO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICByZXR1cm4gZmlsdGVyZWQ7XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIGFkZFVuaXF1ZSh3ZWJzaXRlLCBsaXN0KSB7XG4gICAgICAgICAgICAgICAgaWYgKGxpc3QuaW5kZXhPZih3ZWJzaXRlKSA9PT0gLTEpIHtcbiAgICAgICAgICAgICAgICAgICAgbGlzdC5wdXNoKHdlYnNpdGUpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgZnVuY3Rpb24gbmFtZUNvbnRhaW5zVGVybShuYW1lLCB0ZXJtKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIF8uY29udGFpbnMobmFtZS50b0xvd2VyQ2FzZSgpLCB0ZXJtLnRvTG93ZXJDYXNlKCkpO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBmdW5jdGlvbiBkZXNjcmlwdGlvbkNvbnRhaW5zVGVybShkZXNjcmlwdGlvbiwgdGVybSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfLmNvbnRhaW5zKGRlc2NyaXB0aW9uLnRvTG93ZXJDYXNlKCksIHRlcm0udG9Mb3dlckNhc2UoKSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGZ1bmN0aW9uIG9iamVjdGl2ZXNDb250YWluc1Rlcm0ob2JqZWN0aXZlcywgdGVybSkge1xuICAgICAgICAgICAgICAgIHJldHVybiBfLnNvbWUob2JqZWN0aXZlcywgZnVuY3Rpb24gKG8pIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIF8uY29udGFpbnMoby5jb2RlLnRvTG93ZXJDYXNlKCksIHRlcm0udG9Mb3dlckNhc2UoKSkgfHxcbiAgICAgICAgICAgICAgICAgICAgICAgIF8uY29udGFpbnMoby5uYW1lLnRvTG93ZXJDYXNlKCksIHRlcm0udG9Mb3dlckNhc2UoKSk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cblxuXG4gICAgfVxufSlcbigpOyIsIi8qKlxuICogbm90b3Mud2Vic2l0ZXNcbiAqIEZBQ1RPUlk6IFdlYnNpdGVcbiAqL1xuXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3Mud2Vic2l0ZXMnKVxuICAgICAgICAuZmFjdG9yeSgnV2Vic2l0ZScsIFdlYnNpdGUpO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gV2Vic2l0ZShIVFRQQ2FjaGUpIHtcblxuICAgICAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgICAgICAgIGZ1bGw6IGZ1bGwsXG4gICAgICAgICAgICBnZXRMaXN0OiBnZXRMaXN0XG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgICAgICBmdW5jdGlvbiBnZXRMaXN0KCkge1xuICAgICAgICAgICAgcmV0dXJuIEhUVFBDYWNoZS5zZXJ2aWNlKCd3ZWJzaXRlcycpLmdldExpc3QoKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGZ1bGwoKSB7XG4gICAgICAgICAgICByZXR1cm4gSFRUUENhY2hlLnNlcnZpY2UoJ3dlYnNpdGVzJykub25lKCdmdWxsJykuZ2V0TGlzdCgpO1xuICAgICAgICB9XG4gICAgfVxufSkoKTsiLCIvLyBJbmNsdWRlIGluIGluZGV4Lmh0bWwgc28gdGhhdCBhcHAgbGV2ZWwgZXhjZXB0aW9ucyBhcmUgaGFuZGxlZC5cbi8vIEV4Y2x1ZGUgZnJvbSB0ZXN0UnVubmVyLmh0bWwgd2hpY2ggc2hvdWxkIHJ1biBleGFjdGx5IHdoYXQgaXQgd2FudHMgdG8gcnVuXG4oZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCdibG9ja3MuZXhjZXB0aW9uJylcbiAgICAgICAgLnByb3ZpZGVyKCdleGNlcHRpb25IYW5kbGVyJywgZXhjZXB0aW9uSGFuZGxlclByb3ZpZGVyKVxuICAgICAgICAuY29uZmlnKGNvbmZpZyk7XG5cbiAgICAvKipcbiAgICAgKiBNdXN0IGNvbmZpZ3VyZSB0aGUgZXhjZXB0aW9uIGhhbmRsaW5nXG4gICAgICogQHJldHVybiB7W3R5cGVdfVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGV4Y2VwdGlvbkhhbmRsZXJQcm92aWRlcigpIHtcbiAgICAgICAgLyoganNoaW50IHZhbGlkdGhpczp0cnVlICovXG4gICAgICAgIHRoaXMuY29uZmlnID0ge1xuICAgICAgICAgICAgYXBwRXJyb3JQcmVmaXg6IHVuZGVmaW5lZFxuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuY29uZmlndXJlID0gZnVuY3Rpb24gKGFwcEVycm9yUHJlZml4KSB7XG4gICAgICAgICAgICB0aGlzLmNvbmZpZy5hcHBFcnJvclByZWZpeCA9IGFwcEVycm9yUHJlZml4O1xuICAgICAgICB9O1xuXG4gICAgICAgIHRoaXMuJGdldCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgcmV0dXJuIHtjb25maWc6IHRoaXMuY29uZmlnfTtcbiAgICAgICAgfTtcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDb25maWd1cmUgYnkgc2V0dGluZyBhbiBvcHRpb25hbCBzdHJpbmcgdmFsdWUgZm9yIGFwcEVycm9yUHJlZml4LlxuICAgICAqIEFjY2Vzc2libGUgdmlhIGNvbmZpZy5hcHBFcnJvclByZWZpeCAodmlhIGNvbmZpZyB2YWx1ZSkuXG4gICAgICogQHBhcmFtICB7W3R5cGVdfSAkcHJvdmlkZVxuICAgICAqIEByZXR1cm4ge1t0eXBlXX1cbiAgICAgKiBAbmdJbmplY3RcbiAgICAgKi9cbiAgICBmdW5jdGlvbiBjb25maWcoJHByb3ZpZGUpIHtcbiAgICAgICAgJHByb3ZpZGUuZGVjb3JhdG9yKCckZXhjZXB0aW9uSGFuZGxlcicsIGV4dGVuZEV4Y2VwdGlvbkhhbmRsZXIpO1xuICAgIH1cblxuICAgIC8qKlxuICAgICAqIEV4dGVuZCB0aGUgJGV4Y2VwdGlvbkhhbmRsZXIgc2VydmljZSB0byBhbHNvIGRpc3BsYXkgYSB0b2FzdC5cbiAgICAgKiBAcGFyYW0gIHtPYmplY3R9ICRkZWxlZ2F0ZVxuICAgICAqIEBwYXJhbSAge09iamVjdH0gZXhjZXB0aW9uSGFuZGxlclxuICAgICAqIEBwYXJhbSAge09iamVjdH0gbG9nZ2VyXG4gICAgICogQHJldHVybiB7RnVuY3Rpb259IHRoZSBkZWNvcmF0ZWQgJGV4Y2VwdGlvbkhhbmRsZXIgc2VydmljZVxuICAgICAqL1xuICAgIGZ1bmN0aW9uIGV4dGVuZEV4Y2VwdGlvbkhhbmRsZXIoJGRlbGVnYXRlLCBleGNlcHRpb25IYW5kbGVyLCBsb2dnZXIpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGV4Y2VwdGlvbiwgY2F1c2UpIHtcbiAgICAgICAgICAgIHZhciBhcHBFcnJvclByZWZpeCA9IGV4Y2VwdGlvbkhhbmRsZXIuY29uZmlnLmFwcEVycm9yUHJlZml4IHx8ICcnO1xuICAgICAgICAgICAgdmFyIGVycm9yRGF0YSA9IHtleGNlcHRpb246IGV4Y2VwdGlvbiwgY2F1c2U6IGNhdXNlfTtcbiAgICAgICAgICAgIGV4Y2VwdGlvbi5tZXNzYWdlID0gYXBwRXJyb3JQcmVmaXggKyBleGNlcHRpb24ubWVzc2FnZTtcbiAgICAgICAgICAgICRkZWxlZ2F0ZShleGNlcHRpb24sIGNhdXNlKTtcbiAgICAgICAgICAgIC8qKlxuICAgICAgICAgICAgICogQ291bGQgYWRkIHRoZSBlcnJvciB0byBhIHNlcnZpY2UncyBjb2xsZWN0aW9uLFxuICAgICAgICAgICAgICogYWRkIGVycm9ycyB0byAkcm9vdFNjb3BlLCBsb2cgZXJyb3JzIHRvIHJlbW90ZSB3ZWIgc2VydmVyLFxuICAgICAgICAgICAgICogb3IgbG9nIGxvY2FsbHkuIE9yIHRocm93IGhhcmQuIEl0IGlzIGVudGlyZWx5IHVwIHRvIHlvdS5cbiAgICAgICAgICAgICAqIHRocm93IGV4Y2VwdGlvbjtcbiAgICAgICAgICAgICAqXG4gICAgICAgICAgICAgKiBAZXhhbXBsZVxuICAgICAgICAgICAgICogICAgIHRocm93IHsgbWVzc2FnZTogJ2Vycm9yIG1lc3NhZ2Ugd2UgYWRkZWQnIH07XG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGxvZ2dlci5lcnJvcihleGNlcHRpb24ubWVzc2FnZSwgZXJyb3JEYXRhKTtcbiAgICAgICAgfTtcbiAgICB9XG59KSgpOyIsIi8qKlxuICogYmxvY2tzLmV4Y2VwdGlvblxuICogRkFDVE9SWTogZXhjZXB0aW9uXG4gKi9cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2Jsb2Nrcy5leGNlcHRpb24nKVxuICAgICAgICAuZmFjdG9yeSgnZXhjZXB0aW9uJywgZXhjZXB0aW9uKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIGV4Y2VwdGlvbihsb2dnZXIpIHtcbiAgICAgICAgdmFyIHNlcnZpY2UgPSB7XG4gICAgICAgICAgICBjYXRjaGVyOiBjYXRjaGVyXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBzZXJ2aWNlO1xuXG4gICAgICAgIGZ1bmN0aW9uIGNhdGNoZXIobWVzc2FnZSkge1xuICAgICAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKHJlYXNvbikge1xuICAgICAgICAgICAgICAgIGxvZ2dlci5lcnJvcihtZXNzYWdlLCByZWFzb24pO1xuICAgICAgICAgICAgfTtcbiAgICAgICAgfVxuICAgIH1cbn0pKCk7IiwiLyoqXG4gKiBibG9ja3MubG9nZ2VyXG4gKiBGQUNUT1JZOiBsb2dnZXJcbiAqL1xuXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnYmxvY2tzLmxvZ2dlcicpXG4gICAgICAgIC5mYWN0b3J5KCdsb2dnZXInLCBsb2dnZXIpO1xuXG4gICAgbG9nZ2VyLiRpbmplY3QgPSBbJyRsb2cnLCAndG9hc3RyJ107XG5cbiAgICBmdW5jdGlvbiBsb2dnZXIoJGxvZywgdG9hc3RyKSB7XG4gICAgICAgIHZhciBzZXJ2aWNlID0ge1xuICAgICAgICAgICAgc2hvd1RvYXN0czogdHJ1ZSxcblxuICAgICAgICAgICAgZXJyb3I6IGVycm9yLFxuICAgICAgICAgICAgaW5mbzogaW5mbyxcbiAgICAgICAgICAgIHN1Y2Nlc3M6IHN1Y2Nlc3MsXG4gICAgICAgICAgICB3YXJuaW5nOiB3YXJuaW5nLFxuXG4gICAgICAgICAgICByZW1vdmVkOiByZW1vdmVkLFxuICAgICAgICAgICAgc2F2ZWQ6IHNhdmVkLFxuXG4gICAgICAgICAgICAvLyBzdHJhaWdodCB0byBjb25zb2xlOyBieXBhc3MgdG9hc3RyXG4gICAgICAgICAgICBsb2c6ICRsb2cubG9nXG4gICAgICAgIH07XG5cbiAgICAgICAgcmV0dXJuIHNlcnZpY2U7XG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIGZ1bmN0aW9uIGVycm9yKG1lc3NhZ2UsIGRhdGEsIHRpdGxlKSB7XG4gICAgICAgICAgICB0b2FzdHIuZXJyb3IobWVzc2FnZSwgdGl0bGUpO1xuICAgICAgICAgICAgJGxvZy5lcnJvcignRm91dDogJyArIG1lc3NhZ2UsIGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gaW5mbyhtZXNzYWdlLCBkYXRhLCB0aXRsZSkge1xuICAgICAgICAgICAgdG9hc3RyLmluZm8obWVzc2FnZSwgdGl0bGUpO1xuICAgICAgICAgICAgJGxvZy5pbmZvKCdJbmZvOiAnICsgbWVzc2FnZSwgZGF0YSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBzdWNjZXNzKG1lc3NhZ2UsIGRhdGEsIHRpdGxlKSB7XG4gICAgICAgICAgICB0b2FzdHIuc3VjY2VzcyhtZXNzYWdlLCB0aXRsZSk7XG4gICAgICAgICAgICAkbG9nLmluZm8oJ1N1Y2NlczogJyArIG1lc3NhZ2UsIGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gd2FybmluZyhtZXNzYWdlLCBkYXRhLCB0aXRsZSkge1xuICAgICAgICAgICAgdG9hc3RyLndhcm5pbmcobWVzc2FnZSwgdGl0bGUpO1xuICAgICAgICAgICAgJGxvZy53YXJuKCdMZXQgb3A6ICcgKyBtZXNzYWdlLCBkYXRhKTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHJlbW92ZWQobWVzc2FnZSwgZGF0YSwgdGl0bGUpIHtcbiAgICAgICAgICAgIHRvYXN0ci53YXJuaW5nKG1lc3NhZ2UsIHRpdGxlKTtcbiAgICAgICAgICAgICRsb2cud2FybignVmVyd2lqZGVyZDogJyArIG1lc3NhZ2UsIGRhdGEpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc2F2ZWQobWVzc2FnZSwgZGF0YSwgdGl0bGUpIHtcbiAgICAgICAgICAgIHRvYXN0ci5zdWNjZXNzKG1lc3NhZ2UsIHRpdGxlKTtcbiAgICAgICAgICAgICRsb2cuaW5mbygnQmV3YWFyZDogJyArIG1lc3NhZ2UsIGRhdGEpO1xuICAgICAgICB9XG4gICAgfVxufSkoKTsiLCIvKipcbiAqIG5vdG9zcGx1cy5yb3V0ZXJcbiAqIEZBQ1RPUlk6IHJvdXRlaGVscGVyXG4gKi9cblxuKGZ1bmN0aW9uICgpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ2Jsb2Nrcy5yb3V0ZXInKVxuICAgICAgICAucHJvdmlkZXIoJ3JvdXRlaGVscGVyQ29uZmlnJywgcm91dGVoZWxwZXJDb25maWcpXG4gICAgICAgIC5mYWN0b3J5KCdyb3V0ZWhlbHBlcicsIHJvdXRlaGVscGVyKTtcblxuICAgIHJvdXRlaGVscGVyLiRpbmplY3QgPSBbJ3JvdXRlaGVscGVyQ29uZmlnJywgJyRyb290U2NvcGUnLCAnJHN0YXRlJ107XG5cbiAgICBmdW5jdGlvbiByb3V0ZWhlbHBlckNvbmZpZygpIHtcbiAgICAgICAgLyoganNoaW50IHZhbGlkdGhpczp0cnVlICovXG4gICAgICAgIHRoaXMuY29uZmlnID0ge307XG5cbiAgICAgICAgdGhpcy4kZ2V0ID0gZnVuY3Rpb24gKCkge1xuICAgICAgICAgICAgcmV0dXJuIHtcbiAgICAgICAgICAgICAgICBjb25maWc6IHRoaXMuY29uZmlnXG4gICAgICAgICAgICB9O1xuICAgICAgICB9O1xuICAgIH1cblxuICAgIGZ1bmN0aW9uIHJvdXRlaGVscGVyKHJvdXRlaGVscGVyQ29uZmlnLCAkcm9vdFNjb3BlLCAkc3RhdGUpIHtcbiAgICAgICAgdmFyICR1cmxSb3V0ZXJQcm92aWRlciA9IHJvdXRlaGVscGVyQ29uZmlnLmNvbmZpZy4kdXJsUm91dGVyUHJvdmlkZXI7XG4gICAgICAgIHZhciAkc3RhdGVQcm92aWRlciA9IHJvdXRlaGVscGVyQ29uZmlnLmNvbmZpZy4kc3RhdGVQcm92aWRlcjtcblxuICAgICAgICB2YXIgc2VydmljZSA9IHtcbiAgICAgICAgICAgIGNvbmZpZ3VyZVN0YXRlczogY29uZmlndXJlU3RhdGVzLFxuICAgICAgICAgICAgc3RhdGVzOiBzdGF0ZXMsXG4gICAgICAgICAgICBnZXQ6IGdldFxuICAgICAgICB9O1xuXG4gICAgICAgIGluaXQoKTtcblxuICAgICAgICByZXR1cm4gc2VydmljZTtcbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgZnVuY3Rpb24gY29uZmlndXJlU3RhdGVzKHN0YXRlcykge1xuICAgICAgICAgICAgc3RhdGVzLmZvckVhY2goZnVuY3Rpb24gKHN0YXRlKSB7XG4gICAgICAgICAgICAgICAgaWYgKHN0YXRlLmNvbmZpZy50aXRsZSkge1xuICAgICAgICAgICAgICAgICAgICBzdGF0ZS5jb25maWcubmN5QnJlYWRjcnVtYiA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIGxhYmVsOiBzdGF0ZS5jb25maWcudGl0bGUudG9Mb3dlckNhc2UoKVxuICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgJHN0YXRlUHJvdmlkZXIuc3RhdGUoc3RhdGUuc3RhdGUsIHN0YXRlLmNvbmZpZyk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIHN0YXRlcygpIHtcbiAgICAgICAgICAgIHJldHVybiAkc3RhdGUuZ2V0KCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXQocGF0dGVybikge1xuICAgICAgICAgICAgdmFyIHJlc3VsdCA9IG51bGw7XG4gICAgICAgICAgICBzdGF0ZXMoKS5mb3JFYWNoKGZ1bmN0aW9uIChzdGF0ZSkge1xuICAgICAgICAgICAgICAgIGlmIChzdGF0ZS5uYW1lID09PSBwYXR0ZXJuKSB7XG4gICAgICAgICAgICAgICAgICAgIHJlc3VsdCA9IHN0YXRlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgcmV0dXJuIHJlc3VsdDtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGluaXQoKSB7XG4gICAgICAgICAgICB1cGRhdGVEb2NUaXRsZSgpO1xuICAgICAgICAgICAgJHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnL2luZGV4L2Rhc2hib2FyZCcpO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gdXBkYXRlRG9jVGl0bGUoKSB7XG4gICAgICAgICAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3VjY2VzcycsXG4gICAgICAgICAgICAgICAgZnVuY3Rpb24gKGV2ZW50LCBjdXJyZW50LCBwcmV2aW91cykge1xuICAgICAgICAgICAgICAgICAgICB2YXIgdGl0bGUgPSByb3V0ZWhlbHBlckNvbmZpZy5jb25maWcudGl0bGUgKyAoY3VycmVudC50aXRsZSA/ICcgfCAnICsgY3VycmVudC50aXRsZSA6ICcnKTtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS50aXRsZSA9IHRpdGxlOyAvLyBkYXRhIGJpbmQgdG8gPHRpdGxlPlxuICAgICAgICAgICAgICAgICAgICAkcm9vdFNjb3BlLiRzdGF0ZSA9IGN1cnJlbnQ7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgKTtcbiAgICAgICAgfVxuXG4gICAgfVxufSkoKTsiLCIvKipcbiAqIG5vdG9zLndpZGdldHNcbiAqIERJUkVDVElWRTogbnRGYVxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3Mud2lkZ2V0cycpXG4gICAgICAgIC5kaXJlY3RpdmUoJ250RmEnLCBudEZhKTtcblxuICAgIG50RmEuJGluamVjdCA9IFtdO1xuXG4gICAgZnVuY3Rpb24gbnRGYSgpIHtcbiAgICAgICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICBsaW5rOiBsaW5rRnVuY1xuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBkaXJlY3RpdmU7XG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgICAgICBmdW5jdGlvbiBsaW5rRnVuYyhzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgICAgICAgIHZhciBpID0gYW5ndWxhci5lbGVtZW50KCc8aSBjbGFzcz1cImZhXCIgLz4nKTtcbiAgICAgICAgICAgIHZhciBjbGFzc2VzID0gYXR0cnMubmFtZS5zcGxpdCgnICcpO1xuXG4gICAgICAgICAgICBhbmd1bGFyLmZvckVhY2goY2xhc3NlcywgZnVuY3Rpb24gKHZhbHVlKSB7XG4gICAgICAgICAgICAgICAgaS5hZGRDbGFzcygnZmEtJyArIHZhbHVlKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBlbGVtZW50LnJlcGxhY2VXaXRoKGkpO1xuICAgICAgICB9XG4gICAgfVxufSkoKTtcblxuIiwiLyoqXG4gKiBub3Rvcy53aWRnZXRzXG4gKiBESVJFQ1RJVkU6IG50UGFnaW5hdGlvblxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3Mud2lkZ2V0cycpXG4gICAgICAgIC5kaXJlY3RpdmUoJ250UGFnaW5hdGlvbicsIG50UGFnaW5hdGlvbik7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBudFBhZ2luYXRpb24oJGNvbXBpbGUpIHtcbiAgICAgICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRUEnLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgICAgICB0b3RhbEl0ZW1zOiAnPScsXG4gICAgICAgICAgICAgICAgaXRlbXNQZXJQYWdlOiAnPScsXG4gICAgICAgICAgICAgICAgY3VycmVudFBhZ2U6ICc9J1xuICAgICAgICAgICAgfSxcbiAgICAgICAgICAgIGxpbms6IGxpbmtGdW5jLFxuICAgICAgICAgICAgY29udHJvbGxlcjogUGFnaW5hdGVDb250cm9sbGVyLFxuICAgICAgICAgICAgY29udHJvbGxlckFzOiAndm0nLFxuICAgICAgICAgICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZSAvLyBiZWNhdXNlIHRoZSBzY29wZSBpcyBpc29sYXRlZFxuICAgICAgICB9O1xuXG4gICAgICAgIHJldHVybiBkaXJlY3RpdmU7XG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgICAgICBmdW5jdGlvbiBsaW5rRnVuYyhzY29wZSwgZWxlbWVudCwgYXR0cnMpIHtcbiAgICAgICAgICAgIHZhciBwYWdpbmF0aW9uID0gYW5ndWxhci5lbGVtZW50KCc8cGFnaW5hdGlvbiAvPicpXG4gICAgICAgICAgICBwYWdpbmF0aW9uLmF0dHIoJ2RhdGEtYm91bmRhcnktbGlua3MnLCB0cnVlKTtcbiAgICAgICAgICAgIHBhZ2luYXRpb24uYXR0cignZGF0YS10b3RhbC1pdGVtcycsICd0b3RhbEl0ZW1zJyk7XG4gICAgICAgICAgICBwYWdpbmF0aW9uLmF0dHIoJ2RhdGEtaXRlbXMtcGVyLXBhZ2UnLCAnaXRlbXNQZXJQYWdlJyk7XG4gICAgICAgICAgICBwYWdpbmF0aW9uLmF0dHIoJ2RhdGEtbWF4LXNpemUnLCA1KTtcbiAgICAgICAgICAgIHBhZ2luYXRpb24uYXR0cignZGF0YS1uZy1tb2RlbCcsICdjdXJyZW50UGFnZScpO1xuICAgICAgICAgICAgcGFnaW5hdGlvbi5hdHRyKCdkYXRhLXByZXZpb3VzLXRleHQnLCAn4oC5Jyk7XG4gICAgICAgICAgICBwYWdpbmF0aW9uLmF0dHIoJ2RhdGEtbmV4dC10ZXh0JywgJ+KAuicpO1xuICAgICAgICAgICAgcGFnaW5hdGlvbi5hdHRyKCdkYXRhLWZpcnN0LXRleHQnLCAnwqsnKTtcbiAgICAgICAgICAgIHBhZ2luYXRpb24uYXR0cignZGF0YS1sYXN0LXRleHQnLCAnwrsnKTtcbiAgICAgICAgICAgIHBhZ2luYXRpb24uYXR0cignZGF0YS1uZy1oaWRlJywgJ2hpZGUnKTtcbiAgICAgICAgICAgIGlmIChhdHRyc1snY2xhc3MnXSkge1xuICAgICAgICAgICAgICAgIHBhZ2luYXRpb24uYXR0cignY2xhc3MnLCBhdHRyc1snY2xhc3MnXSk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICRjb21waWxlKHBhZ2luYXRpb24pKHNjb3BlKTtcbiAgICAgICAgICAgIGVsZW1lbnQucmVwbGFjZVdpdGgocGFnaW5hdGlvbik7XG4gICAgICAgIH1cblxuICAgICAgICAvKiBAbmdJbmplY3QgKi9cbiAgICAgICAgZnVuY3Rpb24gUGFnaW5hdGVDb250cm9sbGVyKCRzY29wZSkge1xuICAgICAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgICAgICAgdm0uaGlkZSA9IGZhbHNlO1xuICAgICAgICAgICAgdm0uaXRlbXNQZXJQYWdlID0gMTA7XG4gICAgICAgICAgICB2bS5jdXJyZW50UGdlID0gMDtcblxuICAgICAgICAgICAgJHNjb3BlLiR3YXRjaCgndm0udG90YWxJdGVtcycsIGZ1bmN0aW9uICgpIHtcbiAgICAgICAgICAgICAgICB2bS5oaWRlID0gKHZtLnRvdGFsSXRlbXMgPD0gdm0uaXRlbXNQZXJQYWdlKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9XG4gICAgfVxufSkoKTtcblxuIiwiLyoqXG4gKiBub3Rvcy53aWRnZXRzXG4gKiBGSUxURVI6IG9mZnNldFxuICovXG4oZnVuY3Rpb24gKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgnbm90b3Mud2lkZ2V0cycpXG4gICAgICAgIC5maWx0ZXIoJ29mZnNldCcsIGZpbHRlcik7XG5cblxuICAgIGZ1bmN0aW9uIGZpbHRlcigpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uIG9mZnNldChpbnB1dCwgc3RhcnQpIHtcbiAgICAgICAgICAgIGlmIChpbnB1dCkge1xuICAgICAgICAgICAgICAgIHN0YXJ0ID0gcGFyc2VJbnQoc3RhcnQsIDEwKTtcbiAgICAgICAgICAgICAgICByZXR1cm4gaW5wdXQuc2xpY2Uoc3RhcnQpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgcmV0dXJuIFtdO1xuICAgICAgICB9O1xuICAgIH1cbn0pKCk7Il0sInNvdXJjZVJvb3QiOiIvc291cmNlLyJ9